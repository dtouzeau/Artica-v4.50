#!/bin/sh
# https://www.php.net/downloads.php
# apt-get install libdb-dev  libgdbm-compat-dev libqdbm-dev libgd-dev libonig-dev freetds-dev libc-client-dev firebird-dev libargon2-dev libtidy-dev

# PATH_LIB="/usr/local/lib/php/8.3.4/modules"
# mkdir /usr/c-client
# ln -sf /usr/lib/libc-client.a /usr/c-client/c-client.a
# ln -s /usr/lib/x86_64-linux-gnu/libsybdb.a /usr/lib/libsybdb.a

# CPPFLAGS="-I/usr/include/x86_64-linux-gnu" ./configure --build=x86_64-linux-gnu --prefix=/usr/local/reverse-php/php8.3.4 --includedir=/usr/local/reverse-php/php8.3.4/include --mandir=/usr/local/reverse-php/php8.3.4/share/man --infodir=/usr/local/reverse-php/php8.3.4/share/info --sysconfdir=/usr/local/reverse-php/php8.3.4/etc --localstatedir=/usr/local/reverse-php/php8.3.4/var --disable-option-checking --disable-silent-rules --libdir=/usr/local/reverse-php/php8.3.4/lib --libexecdir=/usr/local/reverse-php/php8.3.4/lib --disable-maintainer-mode --disable-dependency-tracking --enable-cli --disable-cgi --disable-phpdbg --with-config-file-path=/usr/local/reverse-php/php8.3.4/etc/php --with-config-file-scan-dir=/usr/local/reverse-php/php8.3.4/etc/php --host=x86_64-linux-gnu --libexecdir=/usr/local/reverse-php/php8.3.4/lib/php --datadir=/usr/local/reverse-php/php8.3.4/share --program-suffix=8.3 --sysconfdir=/etc --localstatedir=/var --mandir=/usr/share/man --disable-all --disable-debug --disable-rpath --disable-static --disable-dtrace --with-pic --with-layout=GNU --without-pear --enable-filter --with-openssl --with-password-argon2=/usr --with-external-pcre --enable-hash --with-mhash=/usr --with-libxml --enable-session --with-sodium --with-system-tzdata --with-zlib=/usr --with-zlib-dir=/usr --enable-bcmath=shared --with-bz2=shared,/usr --enable-calendar=shared --enable-ctype=shared --enable-exif=shared --enable-fileinfo=shared --with-ffi=shared --enable-ftp=shared --with-openssl-dir=/usr --with-gettext=shared,/usr --with-iconv=shared --enable-pdo=shared --enable-phar=shared --enable-posix=shared --enable-shmop=shared --enable-sockets=shared --enable-sysvmsg=shared --enable-sysvsem=shared --enable-sysvshm=shared --enable-tokenizer=shared --with-curl --enable-dba=shared --with-db5 --without-gdbm --with-qdbm=/usr --with-lmdb=/usr --enable-inifile --enable-flatfile --with-enchant=shared --enable-gd=shared,/usr --with-external-gd --with-gmp=shared --with-imap=shared,/usr/lib --with-kerberos --with-imap-ssl=yes --with-pdo-firebird=shared,/usr --enable-intl=shared --with-ldap --with-ldap-sasl --enable-mbstring=shared --enable-mbregex --enable-mbregex-backtrack --enable-mysqlnd=shared --enable-mysqlnd-compression-support --with-zlib-dir=/usr --with-mysqli=shared,mysqlnd --with-mysql-sock=/var/run/mysqld/mysqld.sock --with-pdo-mysql=shared,mysqlnd --with-mysql-sock=/var/run/mysqld/mysqld.sock --with-unixODBC=shared,/usr --with-pdo-odbc=shared,unixODBC,/usr --with-pgsql=shared,/usr --with-pdo-pgsql=shared,/usr --with-pspell=shared,/usr --with-libedit=shared --with-snmp=shared,/usr --enable-soap=shared --with-libxml-dir=/usr --with-sqlite3=shared,/usr --with-pdo-sqlite=shared,/usr --with-pdo-dblib=shared,/usr --with-tidy=shared,/usr --enable-dom=shared --enable-simplexml=shared --enable-xml=shared --enable-xmlreader=shared --enable-xmlwriter=shared --with-xsl=shared --with-zip=shared --enable-opcache --enable-opcache-file --enable-huge-code-pages  --enable-fpm --with-fpm-user=www-data --with-fpm-group=www-data  --without-fpm-systemd  --program-transform-name='s/^php/revphp-/'

mkdir -p /home/php-multi-builder/usr/local/reverse-php/php8.3.4
strip -s /usr/local/reverse-php/php8.3.4/sbin/php-fpm8.3
strip -s /usr/local/reverse-php/php8.3.4/bin/php8.3
cp -rfv /usr/local/reverse-php/php8.3.4/* /home/php-multi-builder/usr/local/reverse-php/php8.3.4/
cd /home/php-multi-builder
tar -czvf /root/php-multi-builder-8.3.4.tar.gz *


