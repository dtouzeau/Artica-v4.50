<?php


function policyd(){
    $policy["filter"] = "IwojCUV4YW1wbGUgb2YgZm9yYmlkZGluZyBhbGwgYXR0ZW1wdHMgdG8gbG9naW4gdmlhCiMJcmVhbG1zLgojCmRlbnlfcmVhbG1zIHsKCWlmICgmVXNlci1OYW1lICYmICgmVXNlci1OYW1lID1+IC9AfFxcLykpIHsKCQlyZWplY3QKCX0KfQoKIwojCUZpbHRlciB0aGUgdXNlcm5hbWUKIwojICBGb3JjZSBzb21lIHNhbml0eSBvbiBVc2VyLU5hbWUuIFRoaXMgaGVscHMgdG8gYXZvaWQgaXNzdWVzCiMgIGlzc3VlcyB3aGVyZSB0aGUgYmFjay1lbmQgZGF0YWJhc2UgaXMgImZvcmdpdmluZyIgYWJvdXQKIyAgd2hhdCBjb25zdGl0dXRlcyBhIHVzZXIgbmFtZS4KIwpmaWx0ZXJfdXNlcm5hbWUgewoJaWYgKCZVc2VyLU5hbWUpIHsKCQkjCgkJIyAgcmVqZWN0IG1peGVkIGNhc2UgZS5nLiAiVXNlUk5hTWUiCgkJIwoJCSNpZiAoJlVzZXItTmFtZSAhPSAiJXt0b2xvd2VyOiV7VXNlci1OYW1lfX0iKSB7CgkJIwlyZWplY3QKCQkjfQoKCQkjCgkJIyAgcmVqZWN0IGFsbCB3aGl0ZXNwYWNlCgkJIyAgZS5nLiAidXNlckAgc2l0ZS5jb20iLCBvciAidXMgZXIiLCBvciAiIHVzZXIiLCBvciAidXNlciAiCgkJIwoJCWlmICgmVXNlci1OYW1lID1+IC8gLykgewoJCQl1cGRhdGUgcmVxdWVzdCB7CgkJCQkmTW9kdWxlLUZhaWx1cmUtTWVzc2FnZSArPSAnUmVqZWN0ZWQ6IFVzZXItTmFtZSBjb250YWlucyB3aGl0ZXNwYWNlJwoJCQl9CgkJCXJlamVjdAoJCX0KCgkJIwoJCSMgIHJlamVjdCBNdWx0aXBsZSBAJ3MKCQkjICBlLmcuICJ1c2VyQHNpdGUuY29tQHNpdGUuY29tIgoJCSMKCQlpZiAoJlVzZXItTmFtZSA9fiAvQFteQF0qQC8gKSB7CgkJCXVwZGF0ZSByZXF1ZXN0IHsKCQkJCSZNb2R1bGUtRmFpbHVyZS1NZXNzYWdlICs9ICdSZWplY3RlZDogTXVsdGlwbGUgQCBpbiBVc2VyLU5hbWUnCgkJCX0KCQkJcmVqZWN0CgkJfQoKCQkjCgkJIyAgcmVqZWN0IGRvdWJsZSBkb3RzCgkJIyAgZS5nLiAidXNlckBzaXRlLi5jb20iCgkJIwoJCWlmICgmVXNlci1OYW1lID1+IC9cLlwuLyApIHsKCQkJdXBkYXRlIHJlcXVlc3QgewoJCQkJJk1vZHVsZS1GYWlsdXJlLU1lc3NhZ2UgKz0gJ1JlamVjdGVkOiBVc2VyLU5hbWUgY29udGFpbnMgbXVsdGlwbGUgLi5zJwoJCQl9CgkJCXJlamVjdAoJCX0KCgkJIwoJCSMgIG11c3QgaGF2ZSBhdCBsZWFzdCAxIHN0cmluZy1kb3Qtc3RyaW5nIGFmdGVyIEAKCQkjICBlLmcuICJ1c2VyQHNpdGUuY29tIgoJCSMKCQlpZiAoKCZVc2VyLU5hbWUgPX4gL0AvKSAmJiAoJlVzZXItTmFtZSAhfiAvQCguKylcLiguKykkLykpICB7CgkJCXVwZGF0ZSByZXF1ZXN0IHsKCQkJCSZNb2R1bGUtRmFpbHVyZS1NZXNzYWdlICs9ICdSZWplY3RlZDogUmVhbG0gZG9lcyBub3QgaGF2ZSBhdCBsZWFzdCBvbmUgZG90IHNlcGFyYXRvcicKCQkJfQoJCQlyZWplY3QKCQl9CgoJCSMKCQkjICBSZWFsbSBlbmRzIHdpdGggYSBkb3QKCQkjICBlLmcuICJ1c2VyQHNpdGUuY29tLiIKCQkjCgkJaWYgKCZVc2VyLU5hbWUgPX4gL1wuJC8pICB7CgkJCXVwZGF0ZSByZXF1ZXN0IHsKCQkJCSZNb2R1bGUtRmFpbHVyZS1NZXNzYWdlICs9ICdSZWplY3RlZDogUmVhbG0gZW5kcyB3aXRoIGEgZG90JwoJCQl9CgkJCXJlamVjdAoJCX0KCgkJIwoJCSMgIFJlYWxtIGJlZ2lucyB3aXRoIGEgZG90CgkJIyAgZS5nLiAidXNlckAuc2l0ZS5jb20iCgkJIwoJCWlmICgmVXNlci1OYW1lID1+IC9AXC4vKSAgewoJCQl1cGRhdGUgcmVxdWVzdCB7CgkJCQkmTW9kdWxlLUZhaWx1cmUtTWVzc2FnZSArPSAnUmVqZWN0ZWQ6IFJlYWxtIGJlZ2lucyB3aXRoIGEgZG90JwoJCQl9CgkJCXJlamVjdAoJCX0KCX0KfQoKIwojCUZpbHRlciB0aGUgVXNlci1QYXNzd29yZAojCiMgIFNvbWUgZXF1aXBtZW50IHNlbmRzIHBhc3N3b3JkcyB3aXRoIGVtYmVkZGVkIHplcm9zLgojICBUaGlzIHBvbGljeSBmaWx0ZXJzIHRoZW0gb3V0LgojCmZpbHRlcl9wYXNzd29yZCB7CglpZiAoJlVzZXItUGFzc3dvcmQgJiYgXAoJICAgKCZVc2VyLVBhc3N3b3JkICE9ICIle3N0cmluZzpVc2VyLVBhc3N3b3JkfSIpKSB7CgkJdXBkYXRlIHJlcXVlc3QgewoJCQkmVG1wLVN0cmluZy0wIDo9ICIle3N0cmluZzpVc2VyLVBhc3N3b3JkfSIKCQkJJlVzZXItUGFzc3dvcmQgOj0gIiV7c3RyaW5nOlRtcC1TdHJpbmctMH0iCgkJfQoJIH0KfQoKZmlsdGVyX2lubmVyX2lkZW50aXR5IHsKCSMKCSMgIE5vIG5hbWVzLCByZWplY3QuCgkjCglpZiAoISZvdXRlci5yZXF1ZXN0OlVzZXItTmFtZSB8fCAhJlVzZXItTmFtZSkgewoJCXVwZGF0ZSByZXF1ZXN0IHsKCQkJTW9kdWxlLUZhaWx1cmUtTWVzc2FnZSA9ICJVc2VyLU5hbWUgaXMgcmVxdWlyZWQgZm9yIHR1bm5lbGVkIGF1dGhlbnRpY2F0aW9uIgoJCX0KCQlyZWplY3QKCX0KCgkjCgkjICBEbyBkZXRhaWxlZCBjaGVja3Mgb25seSBpZiB0aGUgaW5uZXIgYW5kIG91dGVyCgkjICBOQUlzIGFyZSBkaWZmZXJlbnQuCgkjCgkjICBJZiB0aGUgTkFJcyBhcmUgdGhlIHNhbWUsIGl0IHZpb2xhdGVzIHVzZXIgcHJpdmFjeSwKCSMgIGJ1dCBpcyBhbGxvd2VkLgoJIwoJaWYgKCZvdXRlci5yZXF1ZXN0OlVzZXItTmFtZSAhPSAmVXNlci1OYW1lKSB7CgkJIwoJCSMgIEdldCB0aGUgb3V0ZXIgcmVhbG0uCgkJIwoJCWlmICgmb3V0ZXIucmVxdWVzdDpVc2VyLU5hbWUgPX4gL0AoW15AXSspJC8pIHsKCQkJdXBkYXRlIHJlcXVlc3QgewoJCQkJT3V0ZXItUmVhbG0tTmFtZSA9ICIlezF9IgoJCQl9CgoJCQkjCgkJCSMgIFdoZW4gd2UgaGF2ZSBhbiBvdXRlciByZWFsbSBuYW1lLCB0aGUgdXNlciBwb3J0aW9uCgkJCSMgIE1VU1QgZWl0aGVyIGJlIGVtcHR5LCBvciBiZWdpbiB3aXRoICJhbm9uIi4KCQkJIwoJCQkjICBXZSBkb24ndCBjaGVjayBmb3IgdGhlIGZ1bGwgImFub255bW91cyIsIGJlY2F1c2UKCQkJIyAgc29tZSB2ZW5kb3JzIGRvbid0IGZvbGxvdyB0aGUgc3RhbmRhcmRzLgoJCQkjCgkJCWlmICgmb3V0ZXIucmVxdWVzdDpVc2VyLU5hbWUgIX4gL14oYW5vbnxAKS8pIHsKCQkJCXVwZGF0ZSByZXF1ZXN0IHsKCQkJCQlNb2R1bGUtRmFpbHVyZS1NZXNzYWdlID0gIlVzZXItTmFtZSBpcyBub3QgYW5vbnltaXplZCIKCQkJCX0KCQkJCXJlamVjdAoJCQl9CgkJfQoKCQkjCgkJIyAgVGhlcmUncyBubyBvdXRlciByZWFsbS4gIFRoZSBvdXRlciBOQUkgaXMgZGlmZmVyZW50IGZyb20gdGhlCgkJIyAgaW5uZXIgTkFJLiAgVGhlIFVzZXItTmFtZSBNVVNUIGJlIGFub255bWl6ZWQuCgkJIwoJCSMgIE90aGVyd2lzZSwgeW91IGNvdWxkIGxvZyBpbiBhcyBvdXRlciAiYm9iIiwgYW5kIGlubmVyICJkb3VnIiwKCQkjICBhbmQgd2UnZCBoYXZlIG5vIGlkZWEgd2hpY2ggb25lIHdhcyBjb3JyZWN0LgoJCSMKCQllbHNpZiAoJm91dGVyLnJlcXVlc3Q6VXNlci1OYW1lICF+IC9eYW5vbi8pIHsKCQkJdXBkYXRlIHJlcXVlc3QgewoJCQkJTW9kdWxlLUZhaWx1cmUtTWVzc2FnZSA9ICJVc2VyLU5hbWUgaXMgbm90IGFub255bWl6ZWQiCgkJCX0KCQkJcmVqZWN0CgkJfQoKCQkjCgkJIyAgR2V0IHRoZSBpbm5lciByZWFsbS4KCQkjCgkJaWYgKCZVc2VyLU5hbWUgPX4gL0AoW15AXSspJC8pIHsKCQkJdXBkYXRlIHJlcXVlc3QgewoJCQkJSW5uZXItUmVhbG0tTmFtZSA9ICIlezF9IgoJCQl9CgoJCQkjCgkJCSMgIE5vdGUgdGhhdCB3ZSBkbyBFUVVBTElUWSBjaGVja3MgZm9yIHJlYWxtIG5hbWVzLgoJCQkjICBUaGVyZSBpcyBubyBzaW1wbGUgd2F5IHRvIGRvIGNhc2UgaW5zZW5zaXRpdmUgY2hlY2tzCgkJCSMgIG9uIGludGVybmF0aW9uYWxpemVkIGRvbWFpbiBuYW1lcy4gIFRoZXJlIGlzIG5vIHJlYXNvbgoJCQkjICB0byBhbGxvdyBvdXRlciAiYW5vbnltb3VzQEVYQU1QTEUuQ09NIiBhbmQgaW5uZXIKCQkJIyAgInVzZXJAZXhhbXBsZS5jb20iLiAgVGhlIHVzZXIgc2hvdWxkIGVudGVyIHRoZSBzYW1lCgkJCSMgIHJlYWxtIGZvciBib3RoIGlkZW50aXRpZXMuCgkJCSMKCQkJIyAgSWYgdGhlIGlubmVyIHJlYWxtIGlzbid0IHRoZSBzYW1lIGFzIHRoZSBvdXRlciByZWFsbSwKCQkJIyAgdGhlIGlubmVyIHJlYWxtIE1VU1QgYmUgYSBzdWJkb21haW4gb2YgdGhlIG91dGVyIHJlYWxtLgoJCQkjCgkJCWlmICgmT3V0ZXItUmVhbG0tTmFtZSAmJiBcCgkJCSAgICAoJklubmVyLVJlYWxtLU5hbWUgIT0gJk91dGVyLVJlYWxtLU5hbWUpICYmIFwKCQkJICAgICgmSW5uZXItUmVhbG0tTmFtZSAhfiAvXC4le091dGVyLVJlYWxtLU5hbWV9JC8pKSB7CgkJCQl1cGRhdGUgcmVxdWVzdCB7CgkJCQkJTW9kdWxlLUZhaWx1cmUtTWVzc2FnZSA9ICJJbm5lciByZWFsbSAnJXtJbm5lci1SZWFsbS1OYW1lfScgYW5kIG91dGVyIHJlYWxtICcle091dGVyLVJlYWxtLU5hbWV9JyBhcmUgbm90IGZyb20gdGhlIHNhbWUgZG9tYWluLiIKCQkJCX0KCQkJCXJlamVjdAoJCQl9CgoJCQkjCgkJCSMgIEl0J3MgT0sgdG8gaGF2ZSBhbiBpbm5lciByZWFsbSBhbmQgbm8gb3V0ZXIgcmVhbG0uCgkJCSMKCQkJIyAgVGhhdCB3b24ndCB3b3JrIGZvciByb2FtaW5nLCBidXQgdGhlIGxvY2FsIFJBRElVUyBzZXJ2ZXIKCQkJIyAgY2FuIHN0aWxsIGF1dGhlbnRpY2F0ZSB0aGUgdXNlci4KCQkJIwoJCX0KCgkJIwoJCSMgIEl0J3MgT0sgdG8gaGF2ZSBhbiBvdXRlciByZWFsbSBhbmQgbm8gaW5uZXIgcmVhbG0uCgkJIwoJCSMgIEl0IHdpbGwgd29yayBmb3Igcm9hbWluZywgYW5kIHRoZSBsb2NhbCBSQURJVVMgc2VydmVyCgkJIyAgY2FuIGF1dGhlbnRpY2F0ZSB0aGUgdXNlciB3aXRob3V0IHRoZSByZWFsbS4KCQkjCgl9Cn0=";

    $policy["control"]="IwojICBJZiB5b3Ugd2FudCB0aGUgc2VydmVyIHRvIHByZXRlbmQgdGhhdCBpdCBpcyBkZWFkLAojICB0aGVuIHVzZSB0aGUgImRvX25vdF9yZXNwb25kIiBwb2xpY3kuCiMKZG9fbm90X3Jlc3BvbmQgewoJdXBkYXRlIGNvbnRyb2wgewoJCSZSZXNwb25zZS1QYWNrZXQtVHlwZSA6PSBEby1Ob3QtUmVzcG9uZAoJfQoJaGFuZGxlZAp9CgojCiMgIFNlbmQgQWNjZXNzLUFjY2VwdCBpbW1lZGlhdGVseQojCmFjY2VwdCB7Cgl1cGRhdGUgY29udHJvbCB7CgkJJlJlc3BvbnNlLVBhY2tldC1UeXBlID0gQWNjZXNzLUFjY2VwdAoJfQoJaGFuZGxlZAp9CgojCiMgIFNlbmQgQWNjZXNzLUNoYWxsZW5nZSBpbW1lZGlhdGVseQojCmNoYWxsZW5nZSB7Cgl1cGRhdGUgY29udHJvbCB7CgkJJlJlc3BvbnNlLVBhY2tldC1UeXBlID0gQWNjZXNzLUNoYWxsZW5nZQoJfQoJaGFuZGxlZAp9CgojCiMgIFNlbmQgYW4gQWNjb3VudGluZy1SZXNwb25zZSBpbW1lZGlhdGVseQojCmFjY3RfcmVzcG9uc2UgewoJdXBkYXRlIGNvbnRyb2wgewoJCSZSZXNwb25zZS1QYWNrZXQtVHlwZSA9IEFjY291bnRpbmctUmVzcG9uc2UKCX0KCWhhbmRsZWQKfQo=";

    if (!is_dir("/etc/freeradius/policy.d")) {
        @mkdir("/etc/freeradius/policy.d", 0755, true);
    }

    $policy["abfab-tr"]="IwojICBBQkZBQiBUcnVzdCByb3V0ZXIgcG9saWNpZXMuCiMKIwkkSWQ6IDNhMDg4NTM4YjVhY2MwOWFlYmM4MGI0MDM5MWZlYmYxZDU3YTYxN2EgJAojCgoKIwojIFZlcmlmeSBycCBwYXJhbWV0ZXJzCiMKcHNrX2F1dGhvcml6ZSB7CglpZiAoJlRMUy1QU0stSWRlbnRpdHkpIHsKCQkjIFRPRE86IG1heSBuZWVkIHRvIGNoZWNrIHRydXN0LXJvdXRlci1hcGMgYXMgd2VsbAoJCWlmICgiJXtwc2tzcWw6c2VsZWN0IGRpc3RpbmN0IGtleWlkIGZyb20gYXV0aG9yaXphdGlvbnNfa2V5cyB3aGVyZSBrZXlpZCA9ICcle3Rscy1wc2staWRlbnRpdHl9JyBhbmQgJyV7dHJ1c3Qtcm91dGVyLWNvaX0nIGxpa2UgY29pIGFuZCAnJXtnc3MtYWNjZXB0b3ItcmVhbG0tbmFtZX0nIGxpa2UgYWNjZXB0b3JfcmVhbG0gYW5kICcle2dzcy1hY2NlcHRvci1ob3N0LW5hbWV9JyBsaWtlIGhvc3RuYW1lO30iKSB7CgkJCSMgZG8gdGhpbmdzIGhlcmUKCQl9CgkJZWxzZSB7CgkJdXBkYXRlIHJlcGx5IHsKCQkJUmVwbHktTWVzc2FnZSA9ICJSUCBub3QgYXV0aG9yaXplZCBmb3IgdGhpcyBBQkZBQiByZXF1ZXN0IgoJCQl9CgkJCXJlamVjdAoJCX0KCX0KfQoKYWJmYWJfY2xpZW50X2NoZWNrIHsKCSMgY2hlY2sgdGhhdCBHU1MtQWNjZXB0b3ItSG9zdC1OYW1lIGlzIGNvcnJlY3QKCWlmICgiJXtjbGllbnQ6Z3NzX2FjY2VwdG9yX2hvc3RfbmFtZX0iKSB7CgkJaWYgKCZyZXF1ZXN0OkdTUy1BY2NlcHRvci1Ib3N0LU5hbWUpIHsKCQkJaWYgKCZyZXF1ZXN0OkdTUy1BY2NlcHRvci1Ib3N0LU5hbWUgIT0gIiV7Y2xpZW50Omdzc19hY2NlcHRvcl9ob3N0X25hbWV9IikgewoJCQkJdXBkYXRlIHJlcGx5IHsKCQkJCSAgICAgICAgUmVwbHktTWVzc2FnZSA9ICJHU1MtQWNjZXB0b3ItSG9zdC1OYW1lIGluY29ycmVjdCIKCQkJCQl9CgkJCQlyZWplY3QKCQkJfQoJCX0KCQllbHNlIHsKCQkJIyBzZXQgR1NTLUFjY2VwdG9yLUhvc3QtTmFtZSBpZiBpdCBpcyBub3Qgc2V0IGJ5IHRoZSBtZWNoYW5pc20gCgkJCSMgYnV0IGl0IGlzIGRlZmluZWQgaW4gdGhlIGNsaWVudCBjb25maWd1cmF0aW9uCgkJCXVwZGF0ZSByZXF1ZXN0IHsKCQkJCUdTUy1BY2NlcHRvci1Ib3N0LU5hbWUgPSAiJXtjbGllbnQ6Z3NzX2FjY2VwdG9yX2hvc3RfbmFtZX0iCgkJCX0KCQl9Cgl9CgoJIyBzZXQgVHJ1c3QtUm91dGVyLUNPSSBhdHRyaWJ1dGUgZnJvbSB0aGUgY2xpZW50IGNvbmZpZ3VyYXRpb24KCWlmICgiJXtjbGllbnQ6dHJ1c3Rfcm91dGVyX2NvaX0iKSB7CgkJdXBkYXRlIHJlcXVlc3QgewoJCQlUcnVzdC1Sb3V0ZXItQ09JIDo9ICIle2NsaWVudDp0cnVzdF9yb3V0ZXJfY29pfSIKCQl9Cgl9CgoJIyBzZXQgR1NTLUFjY2VwdG9yLVJlYWxtLU5hbWUgYXR0cmlidXRlIGZyb20gdGhlIGNsaWVudCBjb25maWd1cmF0aW9uCglpZiAoIiV7Y2xpZW50Omdzc19hY2NlcHRvcl9yZWFsbV9uYW1lfSIpIHsKCQl1cGRhdGUgcmVxdWVzdCB7CgkJCUdTUy1BY2NlcHRvci1SZWFsbS1OYW1lIDo9ICIle2NsaWVudDpnc3NfYWNjZXB0b3JfcmVhbG1fbmFtZX0iCgkJfQoJfQoJCgkjIHNldCBHU1MtQWNjZXB0b3ItU2VydmljZS1OYW1lIGF0dHJpYnV0ZSBmcm9tIHRoZSBjbGllbnQgY29uZmlndXJhdGlvbgoJaWYgKCIle2NsaWVudDpnc3NfYWNjZXB0b3Jfc2VydmljZV9uYW1lfSIpIHsKCQl1cGRhdGUgcmVxdWVzdCB7CgkJCUdTUy1BY2NlcHRvci1TZXJ2aWNlLU5hbWUgPSAiJXtjbGllbnQ6Z3NzX2FjY2VwdG9yX3NlcnZpY2VfbmFtZX0iCgkJfQoJfQoKfQoKIyAgQSBwb2xpY3kgd2hpY2ggaXMgdXNlZCB0byB2YWxpZGF0ZSBjaGFubmVsLWJpbmRpbmdzLgojCmFiZmFiX2NoYW5uZWxfYmluZGluZ3MgewoJaWYgKCZHU1MtQWNjZXB0b3ItU2VydmljZS1OYW1lICYmICgmb3V0ZXIucmVxdWVzdDpHU1MtQWNjZXB0b3ItU2VydmljZS1OYW1lICE9ICZHU1MtQWNjZXB0b3ItU2VydmljZS1OYW1lKSkgewoJCXJlamVjdAoJfQoKCWlmICgmR1NTLUFjY2VwdG9yLUhvc3QtTmFtZSAmJiAmb3V0ZXIucmVxdWVzdDpHU1MtQWNjZXB0b3ItSG9zdC1OYW1lICE9ICZHU1MtQWNjZXB0b3ItSG9zdC1OYW1lICkgewoJCXJlamVjdAoJfQoKCWlmICgmR1NTLUFjY2VwdG9yLVJlYWxtLU5hbWUgJiYgJm91dGVyLnJlcXVlc3Q6R1NTLUFjY2VwdG9yLVJlYWxtLU5hbWUgIT0gJkdTUy1BY2NlcHRvci1SZWFsbS1OYW1lICkgewoJCXJlamVjdAoJfQoKCWlmICgmR1NTLUFjY2VwdG9yLVNlcnZpY2UtTmFtZSB8fCAmR1NTLUFjY2VwdG9yLVJlYWxtLU5hbWUgfHwgJkdTUy1BY2NlcHRvci1Ib3N0LU5hbWUpIHsKCQl1cGRhdGUgY29udHJvbCB7CgkJCSZDaGJpbmQtUmVzcG9uc2UtQ29kZSA6PSBzdWNjZXNzCgkJfQoKCQkjCgkJIyAgQUNLIHRoZSBhdHRyaWJ1dGVzIGluIHRoZSByZXF1ZXN0LgoJCSMKCQkjICBJZiBhbnkgb25lIG9mIHRoZXNlIGF0dHJpYnV0ZXMgZG9uJ3QgZXhpc3QgaW4gdGhlIHJlcXVlc3QsCgkJIyAgdGhlbiB0aGV5IHdvbid0IGJlIGNvcGllZCB0byB0aGUgcmVwbHkuCgkJIwoJCXVwZGF0ZSByZXBseSB7CgkJCSZHU1MtQWNjZXB0b3ItU2VydmljZS1OYW1lID0gJkdTUy1BY2NlcHRvci1TZXJ2aWNlLU5hbWUKCQkJJkdTUy1BY2NlcHRvci1Ib3N0LU5hbWUgPSAmR1NTLUFjY2VwdG9yLUhvc3QtTmFtZQoJCQkmR1NTLUFjY2VwdG9yLVJlYWxtLU5hbWUgPSAmR1NTLUFjY2VwdG9yLVJlYWxtLU5hbWUKCQl9Cgl9CgoJIwoJIyAgUmV0dXJuICJoYW5kbGVkIiBzbyB0aGF0IHRoZSAiYXV0aGVudGljYXRlIiBzZWN0aW9uIGlzbid0IHVzZWQuCgkjCgloYW5kbGVkCn0K";

    $policy["accounting"]="IyBXZSBjaGVjayBmb3IgdGhpcyBwcmVmaXggdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGNsYXNzCiMgdmFsdWUgd2FzIGdlbmVyYXRlZCBieSB0aGlzIHNlcnZlci4gIEl0IHNob3VsZCBiZSBjaGFuZ2VkCiMgc28gdGhhdCBpdCBpcyBnbG9iYWxseSB1bmlxdWUuCmNsYXNzX3ZhbHVlX3ByZWZpeCA9ICdhaTonCgojCiMJUmVwbGFjZW1lbnQgZm9yIHRoZSBvbGQgcmxtX2FjY3RfdW5pcXVlIG1vZHVsZQojCmFjY3RfdW5pcXVlIHsKCSMKCSMgIElmIHdlIGhhdmUgYSBjbGFzcyBhdHRyaWJ1dGUgaW4gdGhlIGZvcm1hdAoJIyAgJ2F1dGhfaWQ6WzAtOWEtZl17MzJ9JyBpdCdsbCBoYXZlIGEgbG9jYWwgdmFsdWUKCSMgIChkZWZpbmVkIGJ5IGluc2VydF9hY2N0X2NsYXNzKSwgdGhpcyBlbnN1cmVzCgkjICB1bmlxdWVuZXNzIGFuZCBzdWl0YWJpbGl0eS4KCSMKCSMgIFdlIGNvdWxkIGp1c3QgdXNlIHRoZSBDbGFzcyBhdHRyaWJ1dGUgYXMKCSMgIEFjY3QtVW5pcXVlLVNlc3Npb24tSWQsIGJ1dCB0aGlzIG1heSBjYXVzZSBwcm9ibGVtcwoJIyAgd2l0aCBOQVMgdGhhdCBjYXJyeSBDbGFzcyB2YWx1ZXMgYWNyb3NzIGJldHdlZW4KCSMgIG11bHRpcGxlIGxpbmtlZCBzZXNzaW9ucy4gIFNvIHdlIHJlaGFzaCBjbGFzcyB3aXRoCgkjICBBY2N0LVNlc3Npb24tSUQgdG8gcHJvdmlkZSBhIHRydWVseSB1bmlxdWUgc2Vzc2lvbgoJIyAgaWRlbnRpZmllci4KCSMKCSMgIFVzaW5nIGEgQ2xhc3MvU2Vzc2lvbi1JRCBjb21iaW5hdGlvbiBpcyBtb3JlIHJvYnVzdAoJIyAgdGhhbiB1c2luZyBlbGVtZW50cyBpbiB0aGUgQWNjb3VudGluZy1SZXF1ZXN0LAoJIyAgd2hpY2ggbWF5IGJlIHN1YmplY3QgdG8gY2hhbmdlLCBzdWNoIGFzCgkjICBOQVMtSVAtQWRkcmVzcywgQ2xpZW50LUlQLUFkZHJlc3MgYW5kCgkjICBOQVMtUG9ydC1JRC9OQVMtUG9ydC4KCSMKCSMgIFRoaXMgcG9saWN5IHNob3VsZCBlbnN1cmUgdGhhdCBzZXNzaW9uIGRhdGEgaXMgbm90CgkjICBhZmZlY3RlZCBpZiBOQVMgSVAgYWRkcmVzc2VzIGNoYW5nZSwgb3IgdGhlIGNsaWVudAoJIyAgcm9hbXMgdG8gYSBkaWZmZXJlbnQgJ3BvcnQnIHdoaWxzdCBtYWludGFpbmluZyBpdHMKCSMgIGluaXRpYWwgYXV0aGVudGljYXRpb24gc2Vzc2lvbiAoQ29tbW9uIGluIGEKCSMgIHdpcmVsZXNzIGVudmlyb25tZW50KS4KCSMKCXVwZGF0ZSByZXF1ZXN0IHsKCSAgICAgICAmVG1wLVN0cmluZy05IDo9ICIke3BvbGljeS5jbGFzc192YWx1ZV9wcmVmaXh9IgoJfQoKCWlmICgoIiV7aGV4OiZDbGFzc30iID1+IC9eJXtoZXg6JlRtcC1TdHJpbmctOX0vKSAmJiBcCgkgICAgKCIle3N0cmluZzomQ2xhc3N9IiA9fiAvXiR7cG9saWN5LmNsYXNzX3ZhbHVlX3ByZWZpeH0oWzAtOWEtZl17MzJ9KS9pKSkgewoJCXVwZGF0ZSByZXF1ZXN0IHsKCQkJJkFjY3QtVW5pcXVlLVNlc3Npb24tSWQgOj0gIiV7bWQ1OiV7MX0sJXtBY2N0LVNlc3Npb24tSUR9fSIKCQl9Cgl9CgoJIwoJIyAgTm90IEFsbCBkZXZpY2VzIHJlc3BlY3QgUkZDIDI4NjUgd2hlbiBkZWFsaW5nIHdpdGgKCSMgIHRoZSBjbGFzcyBhdHRyaWJ1dGUsIHNvIGJlIHByZXBhcmVkIHRvIHVzZSB0aGUKCSMgIG9sZGVyIHN0eWxlIG9mIGhhc2hpbmcgc2NoZW1lIGlmIGEgY2xhc3MgYXR0cmlidXRlCgkjICBpcyBub3QgaW5jbHVkZWQKCSMKCWVsc2UgewoJCXVwZGF0ZSByZXF1ZXN0IHsKCQkJJkFjY3QtVW5pcXVlLVNlc3Npb24tSWQgOj0gIiV7bWQ1OiV7VXNlci1OYW1lfSwle0FjY3QtU2Vzc2lvbi1JRH0sJXsle05BUy1JUHY2LUFkZHJlc3N9Oi0le05BUy1JUC1BZGRyZXNzfX0sJXtOQVMtSWRlbnRpZmllcn0sJXtOQVMtUG9ydC1JRH0sJXtOQVMtUG9ydH19IgoJCSB9Cgl9Cn0KCiMKIwlJbnNlcnQgYSAoaG9wZWZ1bGx5IHVuaXF1ZSkgdmFsdWUgaW50byBjbGFzcwojCmluc2VydF9hY2N0X2NsYXNzIHsKCXVwZGF0ZSByZXBseSB7CgkJJkNsYXNzID0gIiR7cG9saWN5LmNsYXNzX3ZhbHVlX3ByZWZpeH0le21kNToldCwlSSwle1BhY2tldC1TcmMtUG9ydH0sJXsle1BhY2tldC1TcmMtSVAtQWRkcmVzc306LSV7UGFja2V0LVNyYy1JUHY2LUFkZHJlc3N9fSwle05BUy1JUC1BZGRyZXNzfSwle0NhbGxpbmctU3RhdGlvbi1JRH0sJXtVc2VyLU5hbWV9fSIKCX0KfQoKIwojCU1lcmdlcyBBY2N0LVtJbnB1dHxPdXRwdXRdLU9jdGV0cyBhbmQgQWNjdC1bSW5wdXR8T3V0cHV0XS1HaWdhd29yZHMgaW50byBBY2N0LVtJbnB1dHxPdXRwdXRdLU9jdGV0czY0CiMKIwlJZiB0aGUgJkF0dHItRm9vIGRvZXNuJ3QgZXhpc3QsIGl0J3MgdmFsdWUgaXMgdGFrZW4gYXMgemVyby4KIwphY2N0X2NvdW50ZXJzNjQucHJlYWNjdCB7Cgl1cGRhdGUgcmVxdWVzdCB7CgkJJkFjY3QtSW5wdXQtT2N0ZXRzNjQgPSAiJXtleHByOigmQWNjdC1JbnB1dC1HaWdhd29yZHMgPDwgMzIpIHwgJkFjY3QtSW5wdXQtT2N0ZXRzfSIKCQkmQWNjdC1PdXRwdXQtT2N0ZXRzNjQgPSAiJXtleHByOigmQWNjdC1PdXRwdXQtR2lnYXdvcmRzIDw8IDMyKSB8ICZBY2N0LU91dHB1dC1PY3RldHN9IgoJfQp9Cgo=";

    $policy["canonicalization"]="IwojCVNwbGl0IFVzZXItTmFtZSBpbiBOQUkgZm9ybWF0IChSRkMgNDI4MikgaW50byBjb21wb25lbnRzCiMKIyAgVGhpcyBwb2xpY3kgd3JpdGVzIHRoZSBVc2VybmFtZSBhbmQgRG9tYWluIHBvcnRpb25zIG9mIHRoZQojICBOQUkgaW50byB0aGUgU3RyaXBwZWQtVXNlci1OYW1lIGFuZCBTdHJpcHBlZC1Vc2VyLURvbWFpbgojICBhdHRyaWJ1dGVzLgojCiMgIFRoZSByZWd1bGFyIGV4cHJlc3Npb24gdG8gZG8gdGhpcyBpcyBub3Qgc3RyaWN0bHkgY29tcGxpYW50CiMgIHdpdGggdGhlIHN0YW5kYXJkLCBidXQgaXQgaXMgbm90IHBvc3NpYmxlIHRvIHdyaXRlIGEKIyAgY29tcGxpYW50IHJlZ2V4cCB3aXRob3V0IHBlcmwgc3R5bGUgcmVndWxhciBleHByZXNzaW9ucyAob3IKIyAgYXQgbGVhc3Qgbm90IGEgbGVnaWJsZSBvbmUpLgojCm5haV9yZWdleHAgPSAnXihbXkBdKikoQChbLVs6YWxudW06XV0rXC5bLVs6YWxudW06XS5dKykpPyQnCgpzcGxpdF91c2VybmFtZV9uYWkgewoJaWYgKCZVc2VyLU5hbWUgJiYgKCZVc2VyLU5hbWUgPX4gLyR7cG9saWN5Lm5haV9yZWdleHB9LykpIHsKCQl1cGRhdGUgcmVxdWVzdCB7CgkJCSZTdHJpcHBlZC1Vc2VyLU5hbWUgOj0gIiV7MX0iCgkJfQoJCQoJCSMgT25seSBhZGQgdGhlIFN0cmlwcGVkLVVzZXItRG9tYWluIGF0dHJpYnV0ZSBpZgoJCSMgd2UgaGF2ZSBhIGRvbWFpbi4gVGhpcyBtZWFucyBwcmVzZW5jZSBjaGVja3MKCQkjIGZvciBTdHJpcHBlZC1Vc2VyLURvbWFpbiB3b3JrLgoJCWlmICgiJXszfSIgIT0gJycpIHsKCQkJdXBkYXRlIHJlcXVlc3QgewoJCQkJJlN0cmlwcGVkLVVzZXItRG9tYWluID0gIiV7M30iCgkJCX0KCQl9CgoJCSMgSWYgYW55IG9mIHRoZSBleHBhbnNpb25zIHJlc3VsdCBpbiBhIG51bGwKCQkjIHN0cmluZywgdGhlIHVwZGF0ZSBzZWN0aW9uIG1heSByZXR1cm4KCQkjIHNvbWV0aGluZyBvdGhlciB0aGFuIHVwZGF0ZWQuLi4KCQl1cGRhdGVkCgl9CgllbHNlIHsKCQlub29wCgl9Cn0KCiMKIyAgSWYgY2FsbGVkIGluIHBvc3QtcHJveHkgd2UgbW9kaWZ5IHRoZSBwcm94eS1yZXBseSBtZXNzYWdlCiMKc3BsaXRfdXNlcm5hbWVfbmFpLnBvc3QtcHJveHkgewoJaWYgKCZwcm94eS1yZXBseTpVc2VyLU5hbWUgJiYgKCZwcm94eS1yZXBseTpVc2VyLU5hbWUgPX4gLyR7cG9saWN5Lm5haV9yZWdleHB9LykpIHsKCQl1cGRhdGUgcHJveHktcmVwbHkgewoJCQkmU3RyaXBwZWQtVXNlci1OYW1lIDo9ICIlezF9IgoJCX0KCQkKCQkjIE9ubHkgYWRkIHRoZSBTdHJpcHBlZC1Vc2VyLURvbWFpbiBhdHRyaWJ1dGUgaWYKCQkjIHdlIGhhdmUgYSBkb21haW4uIFRoaXMgbWVhbnMgcHJlc2VuY2UgY2hlY2tzCgkJIyBmb3IgU3RyaXBwZWQtVXNlci1Eb21haW4gd29yay4KCQlpZiAoIiV7M30iICE9ICcnKSB7CgkJCXVwZGF0ZSBwcm94eS1yZXBseSB7CgkJCQkmU3RyaXBwZWQtVXNlci1Eb21haW4gPSAiJXszfSIKCQkJfQoJCX0KCQl1cGRhdGVkCgl9CgllbHNlIHsKCQlub29wCgl9Cn0KCiMKIyAgTm9ybWFsaXplIHRoZSBNQUMgQWRkcmVzc2VzIGluIHRoZSBDYWxsaW5nL0NhbGxlZC1TdGF0aW9uLUlkCiMKbWFjLWFkZHItcmVnZXhwID0gJyhbMC05YS1mXXsyfSlbXjAtOWEtZl0/KFswLTlhLWZdezJ9KVteMC05YS1mXT8oWzAtOWEtZl17Mn0pW14wLTlhLWZdPyhbMC05YS1mXXsyfSlbXjAtOWEtZl0/KFswLTlhLWZdezJ9KVteMC05YS1mXT8oWzAtOWEtZl17Mn0pJwoKIwojICBBZGQgInJld3JpdGVfY2FsbGVkX3N0YXRpb25faWQiIGluIHRoZSAiYXV0aG9yaXplIiBhbmQKIyAgInByZWFjY3QiIHNlY3Rpb25zLgojCiMgIE1ha2VzIENhbGxlZC1TdGF0aW9uLUlEIGNvbmZvcm0gdG8gd2hhdCBSRkMzNTgwIHNheXMgc2hvdWxkCiMgIGJlIHByb3ZpZGVkIGJ5IDgwMi4xWCBhdXRoZW50aWNhdG9ycy4KIwpyZXdyaXRlX2NhbGxlZF9zdGF0aW9uX2lkIHsKCWlmICgmQ2FsbGVkLVN0YXRpb24tSWQgJiYgKCZDYWxsZWQtU3RhdGlvbi1JZCA9fiAvXiR7cG9saWN5Lm1hYy1hZGRyLXJlZ2V4cH0oW14wLTlhLWZdKC4rKSk/JC9pKSkgewoJCXVwZGF0ZSByZXF1ZXN0IHsKCQkJJkNhbGxlZC1TdGF0aW9uLUlkIDo9ICIle3RvdXBwZXI6JXsxfS0lezJ9LSV7M30tJXs0fS0lezV9LSV7Nn19IgoJCX0KCgkJIyBTU0lEIGNvbXBvbmVudD8KCQlpZiAoIiV7OH0iKSB7CgkJCXVwZGF0ZSByZXF1ZXN0IHsKCQkJCSZDYWxsZWQtU3RhdGlvbi1TU0lEIDo9ICIlezh9IgoJCQl9CgkJfQoJCXVwZGF0ZWQKCX0KCWVsc2UgewoJCW5vb3AKCX0KfQoKIwojICBBZGQgInJld3JpdGVfY2FsbGluZ19zdGF0aW9uX2lkIiBpbiB0aGUgImF1dGhvcml6ZSIgYW5kCiMgICJwcmVhY2N0IiBzZWN0aW9ucy4KIwojICBNYWtlcyBDYWxsaW5nLVN0YXRpb24tSUQgY29uZm9ybSB0byB3aGF0IFJGQzM1ODAgc2F5cyBzaG91bGQKIyAgYmUgcHJvdmlkZWQgYnkgODAyLjFYIGF1dGhlbnRpY2F0b3JzLgojCnJld3JpdGVfY2FsbGluZ19zdGF0aW9uX2lkIHsKCWlmICgmQ2FsbGluZy1TdGF0aW9uLUlkICYmICgmQ2FsbGluZy1TdGF0aW9uLUlkID1+IC9eJHtwb2xpY3kubWFjLWFkZHItcmVnZXhwfSQvaSkpIHsKCQl1cGRhdGUgcmVxdWVzdCB7CgkJCSZDYWxsaW5nLVN0YXRpb24tSWQgOj0gIiV7dG91cHBlcjolezF9LSV7Mn0tJXszfS0lezR9LSV7NX0tJXs2fX0iCgkJfQoJCXVwZGF0ZWQKCX0KCWVsc2UgewoJCW5vb3AKCX0KfQoK";

    $policy["eap"]="IwojCVJlc3BvbnNlIGNhY2hpbmcgdG8gaGFuZGxlIHByb3h5IGZhaWxvdmVycwojClhlYXAuYXV0aG9yaXplIHsKCWNhY2hlX2VhcAoJaWYgKG9rKSB7CgkJIwoJCSMJRXhwaXJlIHByZXZpb3VzIGNhY2hlIGVudHJ5CgkJIwoJCWlmICgmY29udHJvbDpTdGF0ZSkgewoJCQl1cGRhdGUgY29udHJvbCB7CgkJCQkmQ2FjaGUtVFRMIDo9IDAKCQkJfQoJCQljYWNoZV9lYXAKCgkJCXVwZGF0ZSBjb250cm9sIHsKCQkJCSZTdGF0ZSAhKiBBTlkKCQkJfQoJCX0KCgkJaGFuZGxlZAoJfQoJZWxzZSB7CgkJZWFwLmF1dGhvcml6ZQoJfQp9CgojCiMJUG9wdWxhdGUgY2FjaGUgd2l0aCByZXNwb25zZXMgZnJvbSB0aGUgRUFQIG1vZHVsZQojClhlYXAuYXV0aGVudGljYXRlIHsKCWVhcCB7CgkJaGFuZGxlZCA9IDEKCX0KCWlmIChoYW5kbGVkKSB7CgkJY2FjaGVfZWFwLmF1dGhvcml6ZQoKCQloYW5kbGVkCgl9CgoJY2FjaGVfZWFwLmF1dGhvcml6ZQp9CgojCiMgICAgICAgRm9yYmlkIGFsbCBFQVAgdHlwZXMuICBFbmFibGUgdGhpcyBieSBwdXR0aW5nICJmb3JiaWRfZWFwIgojICAgICAgIGludG8gdGhlICJhdXRob3JpemUiIHNlY3Rpb24uCiMKZm9yYmlkX2VhcCB7CglpZiAoJkVBUC1NZXNzYWdlKSB7CgkJcmVqZWN0Cgl9Cn0KCiMKIyAgICAgICBGb3JiaWQgYWxsIG5vbi1FQVAgdHlwZXMgb3V0c2lkZSBvZiBhbiBFQVAgdHVubmVsLgojCnBlcm1pdF9vbmx5X2VhcCB7CglpZiAoISZFQVAtTWVzc2FnZSkgewoJCSMgIFdlIE1BWSBiZSBpbnNpZGUgb2YgYSBUVExTIHR1bm5lbC4KCQkjICBQRUFQIGFuZCBFQVAtRkFTVCByZXF1aXJlIEVBUCBpbnNpZGUgb2YKCQkjICB0aGUgdHVubmVsLCBzbyB0aGlzIGNoZWNrIGlzIE9LLgoJCSMgIElmIHNvLCB0aGVuIHRoZXJlIE1VU1QgYmUgYW4gb3V0ZXIgRUFQIG1lc3NhZ2UuCgkJaWYgKCEmb3V0ZXIucmVxdWVzdCB8fCAhJm91dGVyLnJlcXVlc3Q6RUFQLU1lc3NhZ2UpIHsKCQkJcmVqZWN0CgkJfQoJfQp9CgojCiMgICAgICAgUmVtb3ZlIFJlcGx5LU1lc3NhZ2UgZnJvbSByZXNwb25zZSBpZiB3ZXJlIGRvaW5nIEVBUAojCiMgIEJlIFJGQyAzNTc5IDIuNi41IGNvbXBsaWFudCAtIEVBUC1NZXNzYWdlIGFuZCBSZXBseS1NZXNzYWdlIHNob3VsZAojICBub3QgYmUgcHJlc2VudCBpbiB0aGUgc2FtZSByZXNwb25zZS4KIwpyZW1vdmVfcmVwbHlfbWVzc2FnZV9pZl9lYXAgewoJaWYgKCZyZXBseTpFQVAtTWVzc2FnZSAmJiAmcmVwbHk6UmVwbHktTWVzc2FnZSkgewoJCXVwZGF0ZSByZXBseSB7CgkJCSZSZXBseS1NZXNzYWdlICEqIEFOWQoJCX0KCX0KCWVsc2UgewoJCW5vb3AKCX0KfQo=";

    $policy["moonshot-targeted-ids"]="IwojICBUaGUgZm9sbG93aW5nIHBvbGljaWVzIGdlbmVyYXRlIHRhcmdldGVkIElEcyBmb3IgQUJGQUIgKE1vb25zaG90KQojCiMgIFRoaXMgcG9saWN5IHJlcXVpcmVzIHRoYXQgdGhlIFVVSUQgcGFja2FnZSBpcyBpbnN0YWxsZWQgb24geW91ciBwbGF0Zm9ybQojICBhbmQgdGhhdCB0aGlzIGlzIGNhbGxlZCBmcm9tIHRoZSBpbm5lci10dW5uZWwKIwojICBUaGUgZm9sbG93aW5nIHN0cmluZyBhdHRyaWJ1dGVzIG5lZWQgdG8gZXhpc3QgaW4gdGhlIFVLRVJOQSBkaWN0aW9uYXJ5CiMgIE1vb25zaG90LUhvc3QtVGFyZ2V0ZWRJZCAoMTM4KQojICBNb29uc2hvdC1SZWFsbS1UYXJnZXRlZElkICgxMzkpCiMgIE1vb25zaG90LVRSLUNPSS1UYXJnZXRlZElkICgxNDApCiMgIE1vb25zaG90LU1TVElELUdTUy1BY2NlcHRvciAoMTQxKQojICBNb29uc2hvdC1NU1RJRC1OYW1lc3BhY2UgKDE0MikKIyAgTW9vbnNob3QtTVNUSUQtVGFyZ2V0ZWRJZCAoMTQzKQojCiMgIFRoZXNlIGF0dHJpYnV0ZXMgc2hvdWxkIGFsc28gYmUgbGlzdGVkIGluIHRoZSBhdHRyX2ZpbHRlciBwb2xpY2llcwojICBwb3N0LXByb3h5IGFuZCBwcmUtcHJveHkgd2hlbiB5b3UgdXNlIGF0dHJpYnV0ZSBmaWx0ZXJpbmc6CiMgICAgICAgTW9vbnNob3QtSG9zdC1UYXJnZXRlZElkID0qIEFOWSwKIyAgICAgICBNb29uc2hvdC1SZWFsbS1UYXJnZXRlZElkID0qIEFOWSwKIyAgICAgICBNb29uc2hvdC1UUi1DT0ktVGFyZ2V0ZWRJZCA9KiBBTlksCiMKIAojCiMgIHRhcmdldGVkX2lkX3NhbHQgZGVmaW5pdGlvbgojICBUaGlzIHNhbHQgc2VydmVzIHRoZSBwdXJwb3NlIG9mIHByb3RlY3RpbmcgdGFyZ2V0ZWQgSURzIGFnYWluc3QKIyAgZGljdGlvbmFyeSBhdHRhY2tzLCB0aGVyZWZvcmUgc2hvdWxkIGJlIGNob3NlbiBhcyBhICJyYW5kb20iCiMgIHN0cmluZyBhbmQga2VwdCBzZWNyZXQuCiMKIyAgSWYgeW91IHVzZSBzcGVjaWFsIGNoYXJhY3RlcnMgJSwgeyBhbmQgfSwgZXNjYXBlIHRoZW0gd2l0aCBhIFwgZmlyc3QKIwp0YXJnZXRlZF9pZF9zYWx0ID0gJ2NoYW5nZW1lJwoKIwojICBNb29uc2hvdCBuYW1lc3BhY2VzCiMgIFRoZXNlIG5hbWVzcGFjZXMgYXJlIHVzZWQgZm9yIFVVSUQgZ2VuZXJhdGlvbi4KIyAgVGhleSBzaG91bGQgbm90IGJlIGNoYW5nZWQgYnkgaW1wbGVtZW50b3JzCiMKbW9vbnNob3RfaG9zdF9uYW1lc3BhY2UgPSAnYTU3NGEwNGUtYjdmZi00ODUwLWFhMjQtYTg1OTljN2RlMWM2Jwptb29uc2hvdF9yZWFsbV9uYW1lc3BhY2UgPSAnZGVhNWYyNmQtYTAxMy00NDQ0LTk3N2QtZDA5ZmM5OTBkMmU2Jwptb29uc2hvdF9jb2lfbmFtZXNwYWNlID0gJzE0NWQ3ZTdlLTdkNTQtNDNlZS1iYmNiLTNjNmFkOTQyODI0NycKCgojICBUaGlzIHBvbGljeSBnZW5lcmF0ZXMgYSBob3N0LXNwZWNpZmljIFRhcmdldGVkSWQKIwptb29uc2hvdF9ob3N0X3RpZC5wb3N0LWF1dGggewoJIyAgcmV0cmlldmUgb3IgZ2VuZXJhdGUgYSBVVUlEIGZvciBNb29uc2hvdC1Ib3N0LVRhcmdldGVkSWQKCWlmICgmb3V0ZXIucmVxdWVzdDpHU1MtQWNjZXB0b3ItSG9zdC1OYW1lKSB7CgkJIyBwcmVwIHNvbWUgdmFyaWFibGVzICh1c2VkIHJlZ2FyZGxlc3Mgb2YgU1FMIGJhY2tpbmcgb3Igbm90ISkKCQl1cGRhdGUgY29udHJvbCB7CgkJCU1vb25zaG90LU1TVElELUdTUy1BY2NlcHRvciA6PSAiJXt0b2xvd2VyOiV7b3V0ZXIucmVxdWVzdDpHU1MtQWNjZXB0b3ItSG9zdC1OYW1lfX0iCgkJCU1vb25zaG90LU1TVElELU5hbWVzcGFjZSA6PSAiJHtwb2xpY3kubW9vbnNob3RfaG9zdF9uYW1lc3BhY2V9IgoJCX0KCgkJIyAgaWYgeW91IHdhbnQgdG8gdXNlIFNRTC1iYXNlZCBiYWNraW5nLCByZW1vdmUgdGhlIGNvbW1lbnQgZnJvbQoJCSMgIHRoaXMgbGluZS4gWW91IGFsc28gaGF2ZSB0byBjb25maWd1cmUgYW5kIGVuYWJsZSB0aGUgCgkJIyAgbW9vbnNob3QtdGFyZ2V0ZWQtaWRzIHNxbCBtb2R1bGUgaW4gbW9kcy1lbmFibGVkLiAKCQkjCiMJCW1vb25zaG90X2dldF90YXJnZXRlZF9pZAoKCQkjICBnZW5lcmF0ZSBhIFVVSUQgZm9yIE1vb25zaG90LUhvc3QtVGFyZ2V0ZWRJZAoJCWlmICghJmNvbnRyb2w6TW9vbnNob3QtTVNUSUQtVGFyZ2V0ZWRJZCkgewoJCQkjICBnZW5lcmF0ZSB0aGUgVElECgkJCW1vb25zaG90X21ha2VfdGFyZ2V0ZWRfaWQKCgkJCSMgIGlmIHlvdSB3YW50IHRvIHN0b3JlIHlvdXIgVGFyZ2V0ZWRJZCBpbiBTUUwtYmFzZWQgYmFja2luZywgCgkJCSMgIHJlbW92ZSB0aGUgY29tbWVudCBmcm9tIHRoaXMgbGluZS4gWW91IGFsc28gaGF2ZSB0byBjb25maWd1cmUgCgkJCSMgIGFuZCBlbmFibGUgdGhlIG1vb25zaG90LXRhcmdldGVkLWlkcyBzcWwgbW9kdWxlIGluIG1vZHMtZW5hYmxlZC4KCQkJIwojCQkJbW9vbnNob3RfdGlkX3NxbAoJCX0KCgkJIyAgc2V0IHRoZSBhY3R1YWwgVGFyZ2V0ZWRJZCBpbiB0aGUgc2Vzc2lvbi1zdGF0ZSBsaXN0CgkJaWYgKCZjb250cm9sOk1vb25zaG90LU1TVElELVRhcmdldGVkSWQpIHsKCQkJdXBkYXRlIG91dGVyLnNlc3Npb24tc3RhdGUgewoJCQkJTW9vbnNob3QtSG9zdC1UYXJnZXRlZElkIDo9ICZjb250cm9sOk1vb25zaG90LU1TVElELVRhcmdldGVkSWQKCQkJfQoJCQl1cGRhdGUgY29udHJvbCB7CgkJCQlNb29uc2hvdC1NU1RJRC1UYXJnZXRlZElkICEqIEFOWQoJCQl9CgkJfQoJfQp9CgojICBUaGlzIHBvbGljeSBnZW5lcmF0ZXMgYSByZWFsbS1zcGVjaWZpYyBUYXJnZXRlZElkCiMKbW9vbnNob3RfcmVhbG1fdGlkLnBvc3QtYXV0aCB7CgkjICByZXRyaWV2ZSBvciBnZW5lcmF0ZSBhIFVVSUQgZm9yIE1vb25zaG90LVJlYWxtLVRhcmdldGVkSWQKCWlmICgmb3V0ZXIucmVxdWVzdDpHU1MtQWNjZXB0b3ItUmVhbG0tTmFtZSkgewoJCSMgcHJlcCBzb21lIHZhcmlhYmxlcyAodXNlZCByZWdhcmRsZXNzIG9mIFNRTCBiYWNraW5nIG9yIG5vdCEpCgkJdXBkYXRlIGNvbnRyb2wgewoJCQlNb29uc2hvdC1NU1RJRC1HU1MtQWNjZXB0b3IgOj0gIiV7dG9sb3dlcjole291dGVyLnJlcXVlc3Q6R1NTLUFjY2VwdG9yLVJlYWxtLU5hbWV9fSIKCQkJTW9vbnNob3QtTVNUSUQtTmFtZXNwYWNlIDo9ICIke3BvbGljeS5tb29uc2hvdF9yZWFsbV9uYW1lc3BhY2V9IgoJCX0KCgkJIyAgaWYgeW91IHdhbnQgdG8gdXNlIFNRTC1iYXNlZCBiYWNraW5nLCByZW1vdmUgdGhlIGNvbW1lbnQgZnJvbQoJCSMgIHRoaXMgbGluZS4gWW91IGFsc28gaGF2ZSB0byBjb25maWd1cmUgYW5kIGVuYWJsZSB0aGUgCgkJIyAgbW9vbnNob3QtdGFyZ2V0ZWQtaWRzIHNxbCBtb2R1bGUgaW4gbW9kcy1lbmFibGVkLiAKCQkjCiMJCW1vb25zaG90X2dldF90YXJnZXRlZF9pZAoKCQkjICBnZW5lcmF0ZSBhIFVVSUQgZm9yIE1vb25zaG90LVJlYWxtLVRhcmdldGVkSWQKCQlpZiAoISZjb250cm9sOk1vb25zaG90LU1TVElELVRhcmdldGVkSWQpIHsKCQkJIyAgZ2VuZXJhdGUgdGhlIFRJRAoJCQltb29uc2hvdF9tYWtlX3RhcmdldGVkX2lkCgoJCQkjICBpZiB5b3Ugd2FudCB0byBzdG9yZSB5b3VyIFRhcmdldGVkSWQgaW4gU1FMLWJhc2VkIGJhY2tpbmcsIAoJCQkjICByZW1vdmUgdGhlIGNvbW1lbnQgZnJvbSB0aGlzIGxpbmUuIFlvdSBhbHNvIGhhdmUgdG8gY29uZmlndXJlIAoJCQkjICBhbmQgZW5hYmxlIHRoZSBtb29uc2hvdC10YXJnZXRlZC1pZHMgc3FsIG1vZHVsZSBpbiBtb2RzLWVuYWJsZWQuCgkJCSMKIwkJCW1vb25zaG90X3RpZF9zcWwKCQl9CgoJCSMgIHNldCB0aGUgYWN0dWFsIFRhcmdldGVkSWQgaW4gdGhlIHNlc3Npb24tc3RhdGUgbGlzdAoJCWlmICgmY29udHJvbDpNb29uc2hvdC1NU1RJRC1UYXJnZXRlZElkKSB7CgkJCXVwZGF0ZSBvdXRlci5zZXNzaW9uLXN0YXRlIHsKCQkJCU1vb25zaG90LVJlYWxtLVRhcmdldGVkSWQgOj0gJmNvbnRyb2w6TW9vbnNob3QtTVNUSUQtVGFyZ2V0ZWRJZAoJCQl9CgkJCXVwZGF0ZSBjb250cm9sIHsKCQkJCU1vb25zaG90LU1TVElELVRhcmdldGVkSWQgISogQU5ZCgkJCX0KCQl9Cgl9Cn0KCiMgIFRoaXMgcG9saWN5IGdlbmVyYXRlcyBhIENPSS1zcGVjaWZpYyB0YXJnZXRlZCBJRAojCm1vb25zaG90X2NvaV90aWQucG9zdC1hdXRoIHsKCSMgIHJldHJpZXZlIG9yIGdlbmVyYXRlIGEgVVVJRCBmb3IgTW9vbnNob3QtVFItQ09JLVRhcmdldGVkSWQKCWlmICgmb3V0ZXIucmVxdWVzdDpUcnVzdC1Sb3V0ZXItQ09JKSB7CgkJIyBwcmVwIHNvbWUgdmFyaWFibGVzICh1c2VkIHJlZ2FyZGxlc3Mgb2YgU1FMIGJhY2tpbmcgb3Igbm90ISkKCQl1cGRhdGUgY29udHJvbCB7CgkJCU1vb25zaG90LU1TVElELUdTUy1BY2NlcHRvciA6PSAiJXt0b2xvd2VyOiV7b3V0ZXIucmVxdWVzdDpUcnVzdC1Sb3V0ZXItQ09JfX0iCgkJCU1vb25zaG90LU1TVElELU5hbWVzcGFjZSA6PSAiJHtwb2xpY3kubW9vbnNob3RfY29pX25hbWVzcGFjZX0iCgkJfQoKCQkjICBpZiB5b3Ugd2FudCB0byB1c2UgU1FMLWJhc2VkIGJhY2tpbmcsIHJlbW92ZSB0aGUgY29tbWVudCBmcm9tCgkJIyAgdGhpcyBsaW5lLiBZb3UgYWxzbyBoYXZlIHRvIGNvbmZpZ3VyZSBhbmQgZW5hYmxlIHRoZSAKCQkjICBtb29uc2hvdC10YXJnZXRlZC1pZHMgc3FsIG1vZHVsZSBpbiBtb2RzLWVuYWJsZWQuIAoJCSMKIwkJbW9vbnNob3RfZ2V0X3RhcmdldGVkX2lkCgoJCSMgIGdlbmVyYXRlIGEgVVVJRCBmb3IgTW9vbnNob3QtVFItQ09JLVRhcmdldGVkSWQKCQlpZiAoISZjb250cm9sOk1vb25zaG90LU1TVElELVRhcmdldGVkSWQpIHsKCQkJIyAgZ2VuZXJhdGUgdGhlIFRJRAoJCQltb29uc2hvdF9tYWtlX3RhcmdldGVkX2lkCgoJCQkjICBpZiB5b3Ugd2FudCB0byBzdG9yZSB5b3VyIFRhcmdldGVkSWQgaW4gU1FMLWJhc2VkIGJhY2tpbmcsIAoJCQkjICByZW1vdmUgdGhlIGNvbW1lbnQgZnJvbSB0aGlzIGxpbmUuIFlvdSBhbHNvIGhhdmUgdG8gY29uZmlndXJlIAoJCQkjICBhbmQgZW5hYmxlIHRoZSBtb29uc2hvdC10YXJnZXRlZC1pZHMgc3FsIG1vZHVsZSBpbiBtb2RzLWVuYWJsZWQuCgkJCSMKIwkJCW1vb25zaG90X3RpZF9zcWwKCQl9CgoJCSMgIHNldCB0aGUgYWN0dWFsIFRhcmdldGVkSWQgaW4gdGhlIHNlc3Npb24tc3RhdGUgbGlzdAoJCWlmICgmY29udHJvbDpNb29uc2hvdC1NU1RJRC1UYXJnZXRlZElkKSB7CgkJCXVwZGF0ZSBvdXRlci5zZXNzaW9uLXN0YXRlIHsKCQkJCU1vb25zaG90LVRSLUNPSS1UYXJnZXRlZElkIDo9ICZjb250cm9sOk1vb25zaG90LU1TVElELVRhcmdldGVkSWQKCQkJfQoJCQl1cGRhdGUgY29udHJvbCB7CgkJCQlNb29uc2hvdC1NU1RJRC1UYXJnZXRlZElkICEqIEFOWQoJCQl9CgkJfQoJfQp9CgojICBUaGlzIGlzIHRoZSBnZW5lcmljIGdlbmVyYXRpb24gcG9saWN5LiBJdCByZXF1aXJlcyBtb29uc2hvdF9ob3N0X3RpZCwgbW9vbnNob3RfcmVhbG1fdGlkLCBvciBtb29uc2hvdF9jb2lfdGlkIHRvIHNldCB2YXJpYWJsZXMKIwptb29uc2hvdF9tYWtlX3RhcmdldGVkX2lkLnBvc3QtYXV0aCB7CgkjICB1c2VzIHZhcmlhYmxlcyBzZXQgaW4gdGhlIGNvbnRyb2wgbGlzdAoJIwoJaWYgKCZjb250cm9sOk1vb25zaG90LU1TVElELU5hbWVzcGFjZSAmJiAmY29udHJvbDpNb29uc2hvdC1NU1RJRC1HU1MtQWNjZXB0b3IpIHsKCQkjICB0YXJnZXRlZCBpZCA9ICh1dWlkIC12IDUgW25hbWVzcGFjZV0gW3VzZXJuYW1lXVtzYWx0XVtHU1MgYWNjZXB0b3IgdmFsdWVdKUBbSWRQIHJlYWxtIG5hbWVdCgkJIwoJCWlmICgiJXtlY2hvOi91c3IvYmluL3V1aWQgLXYgNSAle2NvbnRyb2w6TW9vbnNob3QtTVNUSUQtTmFtZXNwYWNlfSAle3RvbG93ZXI6JXtVc2VyLU5hbWV9fSR7cG9saWN5LnRhcmdldGVkX2lkX3NhbHR9JXtjb250cm9sOk1vb25zaG90LU1TVElELUdTUy1BY2NlcHRvcn19IiA9fiAvXihbXiBdKykoWyBdKikkLykgewoJCQl1cGRhdGUgY29udHJvbCB7CgkJCQlNb29uc2hvdC1NU1RJRC1UYXJnZXRlZElkIDo9ICIlezF9QCV7dG9sb3dlcjole3JlcXVlc3Q6UmVhbG19fSIKCQkJfQoJCQlpZiAoJmNvbnRyb2w6TW9vbnNob3QtTVNUSUQtVGFyZ2V0ZWRJZCA9fiAvKFtcJVx7XH1dKykvKSB7CgkJCQl1cGRhdGUgY29udHJvbCB7CgkJCQkJTW9vbnNob3QtTVNUSUQtVGFyZ2V0ZWRJZCAhKiBBTlkKCQkJCX0KCQkJCXVwZGF0ZSBvdXRlci5zZXNzaW9uLXN0YXRlIHsKCQkJCQlNb2R1bGUtRmFpbHVyZS1NZXNzYWdlID0gJ0ludmFsaWQgVGFyZ2V0ZWRJZCBnZW5lcmF0ZWQsIGNoZWNrIHlvdXIgdGFyZ2V0ZWRfaWRfc2FsdCEnCgkJCQl9CgkJCQlyZWplY3QKCQkJfQoJCX0KCQllbHNlIHsKCQkJIyAgd2Ugc2ltcGx5IHJldHVybiB0aGUgJ2VjaG8nIGVycm9yIG1lc3NhZ2UgYXMgdGhlIE1vZHVsZS1GYWlsdXJlLU1lc3NhZ2UsIHVzdWFsbHkgYSBsYWNrIG9mICd1dWlkJwoJCQlyZWplY3QKCQl9Cgl9CgllbHNlIHsKCQkjICBPdXIgdmFyaWFibGVzIHdlcmUgbm90IHNldCwgc28gd2UnbGwgdGhyb3cgYW4gZXJyb3IgYmVjYXVzZSB0aGVyZSdzIG5vIHBvaW50IGluIGNvbnRpbnVpbmchCgkJdXBkYXRlIG91dGVyLnNlc3Npb24tc3RhdGUgewoJCQlNb2R1bGUtRmFpbHVyZS1NZXNzYWdlID0gJ1JlcXVpcmVkIHZhcmlhYmxlcyBmb3IgbW9vbnNob3RfbWFrZV90YXJnZXRlZF9pZCBub3Qgc2V0IScKCQl9CgkJcmVqZWN0Cgl9Cn0KCiMgIFRoaXMgaXMgdGhlIGdlbmVyaWMgcmV0cmlldmFsIHBvbGljeS4gSXQgcmVxdWlyZXMgbW9vbnNob3RfaG9zdF90aWQsIG1vb25zaG90X3JlYWxtX3RpZCwgb3IgbW9vbnNob3RfY29pX3RpZCB0byBzZXQgdmFyaWFibGVzCiMKbW9vbnNob3RfZ2V0X3RhcmdldGVkX2lkLnBvc3QtYXV0aCB7CgkjICB1c2VzIHZhcmlhYmxlcyBzZXQgaW4gdGhlIGNvbnRyb2wgbGlzdAoJIwoJaWYgKCZjb250cm9sOk1vb25zaG90LU1TVElELU5hbWVzcGFjZSAmJiAmY29udHJvbDpNb29uc2hvdC1NU1RJRC1HU1MtQWNjZXB0b3IpIHsKCQkjICByZXRyaWV2ZSB0aGUgVGFyZ2V0ZWRJZAoJCSMKCQl1cGRhdGUgY29udHJvbCB7CgkJCU1vb25zaG90LU1TVElELVRhcmdldGVkSWQgOj0gIiV7bW9vbnNob3RfdGlkX3NxbDpcCgkJCQlTRUxFQ1QgdGFyZ2V0ZWRfaWQgRlJPTSBtb29uc2hvdF90YXJnZXRlZF9pZHMgXAoJCQkJV0hFUkUgZ3NzX2FjY2VwdG9yID0gJyV7Y29udHJvbDpNb29uc2hvdC1NU1RJRC1HU1MtQWNjZXB0b3J9JyBcCgkJCQlBTkQgbmFtZXNwYWNlID0gJyV7Y29udHJvbDpNb29uc2hvdC1NU1RJRC1OYW1lc3BhY2V9JyBcCgkJCQlBTkQgdXNlcm5hbWUgPSAnJXt0b2xvd2VyOiV7VXNlci1OYW1lfX0nfSIKCQl9CgoJCSMgIGlmIHRoZSB2YWx1ZSBpcyBlbXB0eSwgdGhlcmUncyBubyBwb2ludCBpbiBzZXR0aW5nIGl0IGFuZCBkZWxldGUgaXQgZnJvbSB0aGUgY29udHJvbCBsaXN0IQoJCWlmICgmY29udHJvbDpNb29uc2hvdC1NU1RJRC1UYXJnZXRlZElkID09ICcnKSB7CgkJCXVwZGF0ZSBjb250cm9sIHsKCQkJCU1vb25zaG90LU1TVElELVRhcmdldGVkSWQgISogQU5ZCgkJCX0KCQl9Cgl9CgllbHNlIHsKCQkjICBPdXIgdmFyaWFibGVzIHdlcmUgbm90IHNldCwgc28gd2UnbGwgdGhyb3cgYW4gZXJyb3IgYmVjYXVzZSB0aGVyZSdzIG5vIHBvaW50IGluIGNvbnRpbnVpbmchCgkJdXBkYXRlIG91dGVyLnNlc3Npb24tc3RhdGUgewoJCQlNb2R1bGUtRmFpbHVyZS1NZXNzYWdlID0gJ1JlcXVpcmVkIHZhcmlhYmxlcyBmb3IgbW9vbnNob3RfZ2V0X3RhcmdldGVkX2lkIG5vdCBzZXQhJwoJCX0KCQlyZWplY3QKCX0KfQo=";

    $policy["operator-name"]="IwojICBUaGUgZm9sbG93aW5nIHBvbGljaWVzIGFyZSBmb3IgdGhlIE9wZXJhdG9yLU5hbWUKIyAgY29uZmlndXJhdGlvbi4KIwojICBUaGUgcG9saWNpZXMgYmVsb3cgY2FuIGJlIGNhbGxlZCBhcyBqdXN0ICdvcGVyYXRvci1uYW1lJyAobm90CiMgIG9wZXJhdG9yLW5hbWUuYXV0aG9yaXplIGV0Yy4uKSAgZnJvbSB0aGUgdmFyaW91cyBjb25maWcgc2VjdGlvbnMuCiMKCiMgIElmIHlvdSByZXF1aXJlIHRoYXQgdGhlIE9wZXJhdG9yLU5hbWUgYmUgc2V0CiMgIGZvciBsb2NhbCBjbGllbnRzIHRoZW4gY2FsbCB0aGUgJ29wZXJhdG9yLW5hbWUnIHBvbGljeQojICBpbiB0aGUgYXV0aG9yaXplIHNlY3Rpb24gb2YgdGhlIHZpcnR1YWwtc2VydmVyIGZvciB5b3VyIGNsaWVudHMgaW4gY2xpZW50cy5jb25mCgojICBUbyBpbmplY3QgYW4gT3BlcmF0b3ItTmFtZSB3aGlsc3QgcHJveHlpbmcsIGNhbGwgdGhlCiMgICdvcGVyYXRvci1uYW1lJyBwb2xpY3kgaW4gdGhlIHByZS1wcm94eSBzZWN0aW9uIG9mIHRoZSB2aXJ0dWFsIHNlcnZlcgojICBObyBuZWVkIHRvIGNhbGwgdGhpcyBpZiB5b3UgaGF2ZSBhbHJlYWR5IGVuYWJsZWQgdGhpcyBpbgojICB0aGUgYXV0aG9yaXplIHNlY3Rpb24uCgojCiMgIFdlIGFzc3VtZSB0aGF0IGNsaWVudHMgY2FuIGhhdmUgdGhlIG9wZXJhdG9yLW5hbWUgZGVmaW5pdGlvbgojICBpbiB0aGUgY2xpZW50LmNvbmYsIGUuZy4KIyAgY2xpZW50IHh4eHggewojICAgIC4uLgojICAgIE9wZXJhdG9yLU5hbWUgPSAxeW91ci5kb21haW4KIyAgfQojICBJZiB0aGlzIHBhcmFtZXRlciBpcyBmb3VuZCBmb3IgYSBjbGllbnQsIHRoZW4gd2UgYWRkCiMgIGFuIE9wZXJhdG9yLU5hbWUgYXR0cmlidXRlCiMKb3BlcmF0b3ItbmFtZS5hdXRob3JpemUgewoJaWYgKCIle2NsaWVudDpPcGVyYXRvci1OYW1lfSIpIHsKCQl1cGRhdGUgcmVxdWVzdCB7CgkJCSZPcGVyYXRvci1OYW1lID0gIiV7Y2xpZW50Ok9wZXJhdG9yLU5hbWV9IgoJCX0KCX0KfQoKIwojIEJlZm9yZSBwcm94aW5nIHRoZSBjbGllbnQgYWRkIGFuIE9wZXJhdG9yLU5hbWUKIyBhdHRyaWJ1dGUgaWRlbnRpZnlpbmcgdGhpcyBzaXRlIGlmIHRoZSBvcGVyYXRvci1uYW1lIGlzIGZvdW5kIGZvciB0aGlzIGNsaWVudAojCm9wZXJhdG9yLW5hbWUucHJlLXByb3h5IHsKCWlmICgoIiV7cmVxdWVzdDpQYWNrZXQtVHlwZX0iID09ICdBY2Nlc3MtUmVxdWVzdCcpICYmICIle2NsaWVudDpPcGVyYXRvci1OYW1lfSIpIHsKCQl1cGRhdGUgcHJveHktcmVxdWVzdCB7CgkJCSZPcGVyYXRvci1OYW1lIDo9ICIle2NsaWVudDpPcGVyYXRvci1OYW1lfSIKCQl9Cgl9Cn0K";

    $policy["debug"]="IwojICBUaGUgZm9sbG93aW5nIHBvbGljaWVzIGFyZSBmb3IgdGhlIE9wZXJhdG9yLU5hbWUKIyAgY29uZmlndXJhdGlvbi4KIwojICBUaGUgcG9saWNpZXMgYmVsb3cgY2FuIGJlIGNhbGxlZCBhcyBqdXN0ICdvcGVyYXRvci1uYW1lJyAobm90CiMgIG9wZXJhdG9yLW5hbWUuYXV0aG9yaXplIGV0Yy4uKSAgZnJvbSB0aGUgdmFyaW91cyBjb25maWcgc2VjdGlvbnMuCiMKCiMgIElmIHlvdSByZXF1aXJlIHRoYXQgdGhlIE9wZXJhdG9yLU5hbWUgYmUgc2V0CiMgIGZvciBsb2NhbCBjbGllbnRzIHRoZW4gY2FsbCB0aGUgJ29wZXJhdG9yLW5hbWUnIHBvbGljeQojICBpbiB0aGUgYXV0aG9yaXplIHNlY3Rpb24gb2YgdGhlIHZpcnR1YWwtc2VydmVyIGZvciB5b3VyIGNsaWVudHMgaW4gY2xpZW50cy5jb25mCgojICBUbyBpbmplY3QgYW4gT3BlcmF0b3ItTmFtZSB3aGlsc3QgcHJveHlpbmcsIGNhbGwgdGhlCiMgICdvcGVyYXRvci1uYW1lJyBwb2xpY3kgaW4gdGhlIHByZS1wcm94eSBzZWN0aW9uIG9mIHRoZSB2aXJ0dWFsIHNlcnZlcgojICBObyBuZWVkIHRvIGNhbGwgdGhpcyBpZiB5b3UgaGF2ZSBhbHJlYWR5IGVuYWJsZWQgdGhpcyBpbgojICB0aGUgYXV0aG9yaXplIHNlY3Rpb24uCgojCiMgIFdlIGFzc3VtZSB0aGF0IGNsaWVudHMgY2FuIGhhdmUgdGhlIG9wZXJhdG9yLW5hbWUgZGVmaW5pdGlvbgojICBpbiB0aGUgY2xpZW50LmNvbmYsIGUuZy4KIyAgY2xpZW50IHh4eHggewojICAgIC4uLgojICAgIE9wZXJhdG9yLU5hbWUgPSAxeW91ci5kb21haW4KIyAgfQojICBJZiB0aGlzIHBhcmFtZXRlciBpcyBmb3VuZCBmb3IgYSBjbGllbnQsIHRoZW4gd2UgYWRkCiMgIGFuIE9wZXJhdG9yLU5hbWUgYXR0cmlidXRlCiMKb3BlcmF0b3ItbmFtZS5hdXRob3JpemUgewoJaWYgKCIle2NsaWVudDpPcGVyYXRvci1OYW1lfSIpIHsKCQl1cGRhdGUgcmVxdWVzdCB7CgkJCSZPcGVyYXRvci1OYW1lID0gIiV7Y2xpZW50Ok9wZXJhdG9yLU5hbWV9IgoJCX0KCX0KfQoKIwojIEJlZm9yZSBwcm94aW5nIHRoZSBjbGllbnQgYWRkIGFuIE9wZXJhdG9yLU5hbWUKIyBhdHRyaWJ1dGUgaWRlbnRpZnlpbmcgdGhpcyBzaXRlIGlmIHRoZSBvcGVyYXRvci1uYW1lIGlzIGZvdW5kIGZvciB0aGlzIGNsaWVudAojCm9wZXJhdG9yLW5hbWUucHJlLXByb3h5IHsKCWlmICgoIiV7cmVxdWVzdDpQYWNrZXQtVHlwZX0iID09ICdBY2Nlc3MtUmVxdWVzdCcpICYmICIle2NsaWVudDpPcGVyYXRvci1OYW1lfSIpIHsKCQl1cGRhdGUgcHJveHktcmVxdWVzdCB7CgkJCSZPcGVyYXRvci1OYW1lIDo9ICIle2NsaWVudDpPcGVyYXRvci1OYW1lfSIKCQl9Cgl9Cn0K";

    $policy["dhcp"]="IyAgQXNzaWduIGNvbXBhdGliaWxpdHkgZGF0YSB0byByZXF1ZXN0IGZvciBzcWxpcHBvb2wKZGhjcF9zcWxpcHBvb2wucG9zdC1hdXRoIHsKCgoJIyAgRG8gc29tZSBtaW5vciBoYWNrcyB0byB0aGUgcmVxdWVzdCBzbyB0aGF0IGl0IGxvb2tzCgkjICBsaWtlIGEgUkFESVVTIHJlcXVlc3QgdG8gdGhlIFNRTCBJUCBQb29sIG1vZHVsZS4KCXVwZGF0ZSByZXF1ZXN0IHsKCQkmVXNlci1OYW1lID0gIkRIQ1AtJXtESENQLUNsaWVudC1IYXJkd2FyZS1BZGRyZXNzfSIKCQkmQ2FsbGluZy1TdGF0aW9uLUlkID0gIiV7REhDUC1DbGllbnQtSGFyZHdhcmUtQWRkcmVzc30iCgkJJk5BUy1JUC1BZGRyZXNzID0gIiV7JXtESENQLUdhdGV3YXktSVAtQWRkcmVzc306LTEyNy4wLjAuMX0iCgkJJkFjY3QtU3RhdHVzLVR5cGUgPSBTdGFydAoJfQoKCSMgIENhbGwgdGhlIGFjdHVhbCBtb2R1bGUKCWRoY3Bfc3FsaXBwb29sCgoJIyAgQ29udmVydCBGcmFtZWQtSVAtQWRkcmVzcyB0byBESENQLCBidXQgb25seSBpZiB3ZQoJIyAgYWN0dWFsbHkgYWxsb2NhdGVkIGFuIGFkZHJlc3MuCglpZiAob2spIHsKCQl1cGRhdGUgcmVwbHkgewoJCQkmREhDUC1Zb3VyLUlQLUFkZHJlc3MgPSAiJXtyZXBseTpGcmFtZWQtSVAtQWRkcmVzc30iCgkJfQoJfQp9Cgo=";

    $policy["cui"]="IwojICBUaGUgZm9sbG93aW5nIHBvbGljaWVzIGFyZSBmb3IgdGhlIENoYXJnZWFibGUtVXNlci1JZGVudGl0eQojICAoQ1VJKSBjb25maWd1cmF0aW9uLgojCiMgIFRoZSBwb2xpY2llcyBiZWxvdyBjYW4gYmUgY2FsbGVkIGFzIGp1c3QgJ2N1aScgKG5vdAojICBjdWkuYXV0aG9yaXplIGV0Yy4uKSAgZnJvbSB0aGUgdmFyaW91cyBjb25maWcgc2VjdGlvbnMuCiMKCiMKIyAgY3VpX2hhc2hfa2V5IGRlZmluaXRpb24KIyAgVGhpcyBrZXkgc2VydmVzIHRoZSBwdXJwb3NlIG9mIHByb3RlY3RpbmcgQ1VJIHZhbHVlcyBhZ2FpbnN0CiMgIGRpY3Rpb25hcnkgYXR0YWNrcywgdGhlcmVmb3JlIHNob3VsZCBiZSBjaG9zZW4gYXMgYSAicmFuZG9tIgojICBzdHJpbmcgYW5kIGtlcHQgc2VjcmV0LgojCmN1aV9oYXNoX2tleSA9ICJjaGFuZ2VtZSIKCiMKIyBjdWlfcmVxdWlyZV9vcGVyYXRvcl9uYW1lIHN3aXRjaAojIElmIHRoaXMgaXMgc2V0IHRvIG5vbnplcm8gdmFsdWUgdGhlbiBDVUkgd2lsbCBvbmx5IGJlIGFkZGVkCiMgd2hlbiBhIG5vbi1lbXB0eSBPcGVyYXRvci1OYW1lIHZhbHVlIGlzIHByZXNlbnQgaW4gdGhlIHJlcXVlc3QKIwpjdWlfcmVxdWlyZV9vcGVyYXRvcl9uYW1lID0gIm5vIgoKIwojICBUaGUgY2xpZW50IGluZGljYXRlcyBpdCBjYW4gZG8gQ1VJIGJ5IHNlbmRpbmcgYSBDVUkgYXR0cmlidXRlCiMgIGNvbnRhaW5pbmcgb25lIHplcm8gYnl0ZS4KIyAgQSBub24tZW1wdHkgdmFsdWUgaW4gT3BlcmF0b3ItTmFtZSBjYW4gYmUgYW4gYWRkaXRpb25hbCByZXF1aXJlbWVudC4KIyAgTm9ybWFsbHkgQ1VJIHN1cHBvcnQgaXMgdHVybmVkIG9uIG9ubHkgZm9yIHN1Y2ggcmVxdWVzdHMuCiMgIENVSSBzdXBwb3J0IGNhbiBiZSB1c2VkIGZvciBsb2NhbCBjbGllbnRzIHdoaWNoIGRvIG5vdAojICBzdXBwb3J0cyBDVUkgdGhlbXNlbHZlcywgdGhlIHNlcnZlciBjYW4gc2ltdWxhdGUgYSBDVUkgcmVxdWVzdAojICBhZGRpbmcgdGhlIG1pc3NpbmcgTlVMIENVSSB2YWx1ZSBhbmQgdGhlIE9wZXJhdG9yLU5hbWUgYXR0cmlidXRlLgojICBDbGllbnRzIHdoaWNoIGFyZSBzdXBwb3NlZCB0byBnZXQgdGhpcyB0cmVhdG1lbnQgc2hvdWxkCiMgIGJlIG1hcmtlZCBieSBhZGRfY3VpIGZsYWcgaW4gY2xpZW50cy5jb25mCiMgIFdlIGFzc3VtZSB0aGF0IGxvY2FsIGNsaWVudHMgYXJlIG1hcmtlZCBpbiB0aGUgY2xpZW50LmNvbmYgd2l0aAojICBhZGRfY3VpIGZsYWcsIGUuZy4KIyAgY2xpZW50IHh4eHggewojICAgIC4uLgojICAgIGFkZF9jdWkgPSB5ZXMKIyAgfQojCmN1aS5hdXRob3JpemUgewoJaWYgKCIle2NsaWVudDphZGRfY3VpfSIgPT0gJ3llcycpIHsKCQl1cGRhdGUgcmVxdWVzdCB7CgkJCSZDaGFyZ2VhYmxlLVVzZXItSWRlbnRpdHkgOj0gMHgwMAoJCX0KCX0KfQoKIwojICBCZWZvcmUgcHJveGluZyBhbiBBY2Nlc3MtUmVxdWVzdCB0byBhIHJlbW90ZSBzZXJ2ZXIsIGEgTlVMIENVSQojICBhdHRyaWJ1dGUgc2hvdWxkIGJlIGFkZGVkLCB1bmxlc3MgaXQgaXMgYWxyZWFkeSBwcmVzZW50IGluIHRoZSByZXF1ZXN0LgojCmN1aS5wcmUtcHJveHkgewoJaWYgKCgiJXtyZXF1ZXN0OlBhY2tldC1UeXBlfSIgPT0gJ0FjY2Vzcy1SZXF1ZXN0JykgJiYgKCIle2NsaWVudDphZGRfY3VpfSIgPT0gJ3llcycpKSB7CgkJdXBkYXRlIHByb3h5LXJlcXVlc3QgewoJCQkmQ2hhcmdlYWJsZS1Vc2VyLUlkZW50aXR5ID0gMHgwMAoJCX0KCX0KfQoKCiMKIyAgQWRkIGEgQ1VJIGF0dHJpYnV0ZSBiYXNlZCBvbiB0aGUgVXNlci1OYW1lLCBhbmQgYSBzZWNyZXQga2V5CiMgIGtub3duIG9ubHkgdG8gdGhpcyBzZXJ2ZXIuCiMgIEZvciBFQVAtVFRMUyBhbmQgRUFQLVBFQVAgbWV0aG9kcwojICB1c2VfdHVubmVsZWRfcmVwbHkgcGFyYW1ldGVyIE1VU1QgYmUgc2V0IHRvIHllcwojCmN1aS5wb3N0LWF1dGggewoJaWYgKCEmY29udHJvbDpQcm94eS1Uby1SZWFsbSAmJiAmQ2hhcmdlYWJsZS1Vc2VyLUlkZW50aXR5ICYmICEmcmVwbHk6Q2hhcmdlYWJsZS1Vc2VyLUlkZW50aXR5ICYmIFwKCSAgICAoJk9wZXJhdG9yLU5hbWUgfHwgKCcke3BvbGljeS5jdWlfcmVxdWlyZV9vcGVyYXRvcl9uYW1lfScgIT0gJ3llcycpKSApIHsKCQl1cGRhdGUgcmVwbHkgewoJCQkmQ2hhcmdlYWJsZS1Vc2VyLUlkZW50aXR5ID0gIiV7c2hhMToke3BvbGljeS5jdWlfaGFzaF9rZXl9JXt0b2xvd2VyOiV7VXNlci1OYW1lfSV7JXtPcGVyYXRvci1OYW1lfTotfX19IgoJCX0KCX0KCgkjCgkjICBUaGUgc2VjdGlvbiBiZWxvdyB3aWxsIHN0b3JlIGEgQ1VJIGZvciB0aGUgVXNlciBpbiB0aGUgREIgYW5kIHJlbW92ZSB0aGUKCSMgIFVzZXItTmFtZSBhdHRyaWJ1dGUgZnJvbSB0aGUgcmVwbHkgaWYgYSBDVUkgaXMgcHJlc2VudC4KCSMKCSMgIFlvdSBuZWVkIHRvIGNvbmZpZ3VyZSB0aGUgY3Vpc3FsIG1vZHVsZSBhbmQgeW91ciBkYXRhYmFzZSBmb3IgdGhpcyB0byB3b3JrLgoJIyAgSWYgeW91ciBOQVMgY2FuIGRvIENVSSBiYXNlZCBhY2NvdW50aW5nIHRoZW1zZWx2ZXMgb3IgeW91IGRvIG5vdCBjYXJlIGFib3V0CgkjICBhY2NvdW50aW5nLCBjb21tZW50IG91dCB0aGUgJ2N1aXNxbCcgbGluZSBiZWxvdy4KCSMKCWlmICgmcmVwbHk6Q2hhcmdlYWJsZS1Vc2VyLUlkZW50aXR5KSB7CgkJIyBGb3JjZSBVc2VyLU5hbWUgdG8gYmUgdGhlIFVzZXItTmFtZSBmcm9tIHRoZSByZXF1ZXN0CgkJdXBkYXRlIHsKCQkJJnJlcGx5OlVzZXItTmFtZSA6PSAmcmVxdWVzdDpVc2VyLU5hbWUKCQl9CgkJY3Vpc3FsCgl9Cn0KCgpjdWktaW5uZXIucG9zdC1hdXRoIHsKCWlmICgmb3V0ZXIucmVxdWVzdDpDaGFyZ2VhYmxlLVVzZXItSWRlbnRpdHkgJiYgXAoJICAgICgmb3V0ZXIucmVxdWVzdDpPcGVyYXRvci1OYW1lIHx8ICgnJHtwb2xpY3kuY3VpX3JlcXVpcmVfb3BlcmF0b3JfbmFtZX0nICE9ICd5ZXMnKSkpIHsKCQl1cGRhdGUgcmVwbHkgewoJCQkmQ2hhcmdlYWJsZS1Vc2VyLUlkZW50aXR5IDo9ICIle3NoYTE6JHtwb2xpY3kuY3VpX2hhc2hfa2V5fSV7dG9sb3dlcjole1VzZXItTmFtZX0leyV7b3V0ZXIucmVxdWVzdDpPcGVyYXRvci1OYW1lfTotfX19IgoJCX0KCX0KfQoKIwojICBJZiB5b3VyIE5BUyBjYW4gZG8gQ1VJIGJhc2VkIGFjY291bnRpbmcgb3IgeW91IGRvIG5vdCBjYXJlIGFib3V0CiMgIGFjY291bnRpbmcgdGhlbiBqdXN0IGNvbW1lbnQgb3V0IHRoZSBjYWxsIHRvIGN1aSBpbiAuLi4uLi4KIwojICBJZiB3ZSBoYWQgc3RvcmVkIGEgQ1VJIGZvciB0aGUgVXNlciwgYWRkIGl0IHRvIHRoZSByZXF1ZXN0LgojCmN1aS5hY2NvdW50aW5nIHsKCSMKCSMgIElmIHRoZSBDVUkgaXNuJ3QgaW4gdGhlIHBhY2tldCwgc2VlIGlmIHdlIGNhbiBmaW5kIGl0CgkjICBpbiB0aGUgREIuCgkjCglpZiAoISZDaGFyZ2VhYmxlLVVzZXItSWRlbnRpdHkpIHsKCQl1cGRhdGUgcmVxdWVzdCB7CgkJCSZDaGFyZ2VhYmxlLVVzZXItSWRlbnRpdHkgOj0gIiV7Y3Vpc3FsOlwKCQkJCVNFTEVDVCBjdWkgRlJPTSBjdWkgXAoJCQkJV0hFUkUgY2xpZW50aXBhZGRyZXNzID0gJyV7JXtQYWNrZXQtU3JjLUlQdjYtQWRkcmVzc306LSV7UGFja2V0LVNyYy1JUC1BZGRyZXNzfX0nIFwKCQkJCUFORCBjYWxsaW5nc3RhdGlvbmlkID0gJyV7Q2FsbGluZy1TdGF0aW9uLUlkfScgXAoJCQkJQU5EIHVzZXJuYW1lID0gJyV7VXNlci1OYW1lfSd9IgoJCX0KCX0KCgkjCgkjICBJZiBpdCBleGlzdHMgbm93LCB0aGVuIHdyaXRlIG91dCB3aGVuIHdlIGxhc3Qgc2F3CgkjICB0aGlzIENVSS4KCSMKCWlmICgmQ2hhcmdlYWJsZS1Vc2VyLUlkZW50aXR5ICYmICgmQ2hhcmdlYWJsZS1Vc2VyLUlkZW50aXR5ICE9ICcnKSkgewoJCWN1aXNxbAoJfQp9Cg==";

    foreach ($policy as $fname => $encoded) {
        @file_put_contents("/etc/freeradius/policy.d/$fname", base64_decode($encoded));
        _out("Starting:/etc/freeradius/policy.d/$fname done...");
        if(is_file("/etc/freeradius/3.0/policy.d/$fname")){@unlink("/etc/freeradius/3.0/policy.d/$fname");}

    }
}

function freeradius_CheckDirs(){
    $dirs[]="/etc/freeradius";
    $dirs[]="/etc/freeradius/modules";
    $dirs[]="/etc/freeradius/mods-config";
    $dirs[]="/etc/freeradius/mods-config/files";
    $dirs[]="/etc/freeradius/mods-config/attr_filter";
    $dirs[]="/etc/freeradius/mods-config/preprocess";
    foreach ($dirs as $path){
        if(!is_dir($path)){
            @mkdir($path,0755,true);
        }
        @chmod($path,0755);
        @chown("freerad",$path);
        @chgrp("freerad",$path);
    }
}

function freeradius_modules(){
    freeradius_CheckDirs();
    $f=array();
    $f[]="preprocess {";
    $f[]="	moddir = \${modconfdir}/\${.:instance}";
    $f[]="	huntgroups = \${moddir}/huntgroups";
    $f[]="	hints = \${moddir}/hints";
    $f[]="	with_ntdomain_hack = yes";
    $f[]="	with_specialix_jetstream_hack = no";
    $f[]="	with_cisco_vsa_hack = no";
    $f[]="}";
    $f[]="";

    @file_put_contents("/etc/freeradius/modules/preprocess", @implode("\n", $f));
    _out("Starting:/etc/freeradius/modules/preprocess done...");

    $f=array();
    $f[]="# -*- text -*-";
    $f[]="exec {";
    $f[]="	wait = no";
    $f[]="	input_pairs = request";
    $f[]="	shell_escape = yes";
    $f[]="	output = none";
    $f[]="	timeout = 10";
    $f[]="}";
    $f[]="";

    @file_put_contents("/etc/freeradius/modules/exec", @implode("\n", $f));
    _out("Starting:/etc/freeradius/modules/exec done...");

    $f=array();
    $f[]="#";
    $f[]="#  \$Id: 82319c033bbf349991a46b8f198a5bf5487b5da8 \$";
    $f[]="radutmp {";
    $f[]="	filename = \${logdir}/radutmp";
    $f[]="	username = %{User-Name}";
    $f[]="	case_sensitive = yes";
    $f[]="	check_with_nas = yes";
    $f[]="	permissions = 0600";
    $f[]="	caller_id = \"yes\"";
    $f[]="}";
    $f[]="";

    @file_put_contents("/etc/freeradius/modules/radutmp", @implode("\n", $f));
    _out("Starting:/etc/freeradius/modules/radutmp done...");

    $f=array();
    $f[]="detail {";
    $f[]="	filename = \${radacctdir}/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d";
    $f[]="#	filename = \${radacctdir}/detail";
    $f[]="	permissions = 0600";
    $f[]="#	group = \${security.group}";
    $f[]="	header = \"%t\"";
    $f[]="#	locking = yes";
    $f[]="#	log_packet_header = yes";
    $f[]="	#suppress {";
    $f[]="		# User-Password";
    $f[]="	#}";
    $f[]="}\n";
    @file_put_contents("/etc/freeradius/modules/detail", @implode("\n", $f));
    @file_put_contents("/etc/freeradius/mods-enabled/detail", @implode("\n", $f));
    _out("Starting:/etc/freeradius/modules/detail done...");

    $f=array();
    $f[]="unix {";
    $f[]="\tradwtmp = \${logdir}/radwtmp";
    $f[]="}";
    $f[]="";
    @file_put_contents("/etc/freeradius/modules/unix", @implode("\n", $f));
    _out("Starting:/etc/freeradius/modules/unix done...");

    $f=array();
    $f[]="# -*- text -*-";
    $f[]="#";
    $f[]="#  \$Id: f0aa9edf9da33d63fe03e7d1ed3cbca848eec54d $";
    $f[]="";
    $f[]="#";
    $f[]="#  The 'digest' module currently has no configuration.";
    $f[]="#";
    $f[]="#  \"Digest\" authentication against a Cisco SIP server.";
    $f[]="#  See 'doc/rfc/draft-sterman-aaa-sip-00.txt' for details";
    $f[]="#  on performing digest authentication for Cisco SIP servers.";
    $f[]="#";
    $f[]="digest {";
    $f[]="}";
    $f[]="";
    @file_put_contents("/etc/freeradius/modules/digest", @implode("\n", $f));
    _out("Starting:/etc/freeradius/modules/digest done...");


    $f=array();
    $f[]="# -*- text -*-";
    $f[]="#";
    $f[]="#  \$Id: e2a3cd3b110ffffdbcff86c7fc65a9275ddc3379 $";
    $f[]="# auth_log module";
    $f[]="#";
    $f[]="#";
    $f[]="detail auth_log {";
    $f[]="\tfilename = /var/log/freeradius/auth.log";
    $f[]="\tpermissions= 0600";
    $f[]="\theader = \"%{Packet-Src-IP-Address} - %t\"";
    $f[]="\tlog_packet_header = yes";
    $f[]="\tsuppress {";
    $f[]="\t\tUser-Password";
    $f[]="\t}";
    $f[]="}";
    $f[]="";
    @file_put_contents("/etc/freeradius/modules/auth_log", @implode("\n", $f));
    _out("Starting:/etc/freeradius/modules/auth_log done...");

    $f=array();
    $f[]="# -*- text -*-";
    $f[]="#";
    $f[]="#  \$Id: e2a3cd3b110ffffdbcff86c7fc65a9275ddc3379 $";
    $f[]="# CHAP module";
    $f[]="#";
    $f[]="#  To authenticate requests containing a CHAP-Password attribute.";
    $f[]="#";
    $f[]="chap {";
    $f[]="	# no configuration";
    $f[]="}";
    $f[]="";
    @file_put_contents("/etc/freeradius/modules/chap", @implode("\n", $f));
    _out("Starting:/etc/freeradius/modules/chap done...");

    $f=array();
    $f[]="";
    $f[]="logintime {";
    $f[]="	minimum_timeout = 60";
    $f[]="}";
    $f[]="";
    @file_put_contents("/etc/freeradius/modules/logintime", @implode("\n", $f));
    _out("Starting:/etc/freeradius/modules/logintime done...");

    $f=array();
    $f[]="";
    $f[]="expiration {";
    $f[]="}";
    $f[]="";
    @file_put_contents("/etc/freeradius/modules/expiration", @implode("\n", $f));
    _out("Starting:/etc/freeradius/modules/expiration done...");

    $f=array();
    $f[]="expr {";
    $f[]="	safe_characters = \"@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /\"";
    $f[]="}";
    $f[]="";
    @file_put_contents("/etc/freeradius/modules/expr", @implode("\n", $f));
    _out("Starting:/etc/freeradius/modules/expr done...");

    $f=array();
    $f[]="# -*- text -*-";
    $f[]="files {";
    $f[]="	moddir = \${modconfdir}/\${.:instance}";
    $f[]="	#key = \"%{%{Stripped-User-Name}:-%{User-Name}}\"";
    $f[]="	filename = \${moddir}/authorize";
    $f[]="	usersfile = \${moddir}/authorize";
    $f[]="	acctusersfile = \${moddir}/accounting";
    $f[]="	preproxy_usersfile = \${moddir}/pre-proxy";
    $f[]="}";
    $f[]="";
    @file_put_contents("/etc/freeradius/modules/files", @implode("\n", $f));
    _out("Starting:/etc/freeradius/modules/files done...");

    $mods_enabled["attr_filter"] = "IyAtKi0gdGV4dCAtKi0KIwojICAkSWQ6IDFjYWZmMDc3YjI0MjljOTQ4YTA0Nzc3ZmNkNjE5YmU5MDFhYzgzZGMgJAoKIwojICBUaGlzIGZpbGUgZGVmaW5lcyBhIG51bWJlciBvZiBpbnN0YW5jZXMgb2YgdGhlICJhdHRyX2ZpbHRlciIgbW9kdWxlLgojCgojIGF0dHJfZmlsdGVyIC0gZmlsdGVycyB0aGUgYXR0cmlidXRlcyByZWNlaXZlZCBpbiByZXBsaWVzIGZyb20KIyBwcm94aWVkIHNlcnZlcnMsIHRvIG1ha2Ugc3VyZSB3ZSBzZW5kIGJhY2sgdG8gb3VyIFJBRElVUyBjbGllbnQKIyBvbmx5IGFsbG93ZWQgYXR0cmlidXRlcy4KYXR0cl9maWx0ZXIgYXR0cl9maWx0ZXIucG9zdC1wcm94eSB7CglrZXkgPSAiJXtSZWFsbX0iCglmaWxlbmFtZSA9ICR7bW9kY29uZmRpcn0vJHsuOm5hbWV9L3Bvc3QtcHJveHkKfQoKIyBhdHRyX2ZpbHRlciAtIGZpbHRlcnMgdGhlIGF0dHJpYnV0ZXMgaW4gdGhlIHBhY2tldHMgd2Ugc2VuZCB0bwojIHRoZSBSQURJVVMgaG9tZSBzZXJ2ZXJzLgphdHRyX2ZpbHRlciBhdHRyX2ZpbHRlci5wcmUtcHJveHkgewoJa2V5ID0gIiV7UmVhbG19IgoJZmlsZW5hbWUgPSAke21vZGNvbmZkaXJ9LyR7LjpuYW1lfS9wcmUtcHJveHkKfQoKIyBFbmZvcmNlIFJGQyByZXF1aXJlbWVudHMgb24gdGhlIGNvbnRlbnRzIG9mIEFjY2Vzcy1SZWplY3QKIyBwYWNrZXRzLiAgU2VlIHRoZSBjb21tZW50cyBhdCB0aGUgdG9wIG9mIHRoZSBmaWxlIGZvcgojIG1vcmUgZGV0YWlscy4KIwphdHRyX2ZpbHRlciBhdHRyX2ZpbHRlci5hY2Nlc3NfcmVqZWN0IHsKCWtleSA9ICIle1VzZXItTmFtZX0iCglmaWxlbmFtZSA9ICR7bW9kY29uZmRpcn0vJHsuOm5hbWV9L2FjY2Vzc19yZWplY3QKfQoKIyBFbmZvcmNlIFJGQyByZXF1aXJlbWVudHMgb24gdGhlIGNvbnRlbnRzIG9mIEFjY2Vzcy1DaGFsbGVuZ2UKIyBwYWNrZXRzLiAgU2VlIHRoZSBjb21tZW50cyBhdCB0aGUgdG9wIG9mIHRoZSBmaWxlIGZvcgojIG1vcmUgZGV0YWlscy4KIwphdHRyX2ZpbHRlciBhdHRyX2ZpbHRlci5hY2Nlc3NfY2hhbGxlbmdlIHsKCWtleSA9ICIle1VzZXItTmFtZX0iCglmaWxlbmFtZSA9ICR7bW9kY29uZmRpcn0vJHsuOm5hbWV9L2FjY2Vzc19jaGFsbGVuZ2UKfQoKCiMgIEVuZm9yY2UgUkZDIHJlcXVpcmVtZW50cyBvbiB0aGUgY29udGVudHMgb2YgdGhlCiMgIEFjY291bnRpbmctUmVzcG9uc2UgcGFja2V0cy4gIFNlZSB0aGUgY29tbWVudHMgYXQgdGhlCiMgIHRvcCBvZiB0aGUgZmlsZSBmb3IgbW9yZSBkZXRhaWxzLgojCmF0dHJfZmlsdGVyIGF0dHJfZmlsdGVyLmFjY291bnRpbmdfcmVzcG9uc2UgewoJa2V5ID0gIiV7VXNlci1OYW1lfSIKCWZpbGVuYW1lID0gJHttb2Rjb25mZGlyfS8key46bmFtZX0vYWNjb3VudGluZ19yZXNwb25zZQp9Cg==";


    $mods_enabled["always"] = "IyAtKi0gdGV4dCAtKi0KIwojICAkSWQ6IGRlM2YxMzA4OWQ4OTUxZjRjODIyZWJjNDAwN2RmNThlMDQ4N2RlMTQgJAoKIwojICBUaGUgImFsd2F5cyIgbW9kdWxlIGlzIGhlcmUgZm9yIGRlYnVnZ2luZyBwdXJwb3Nlcywgb3IKIyAgZm9yIHVzZSBpbiBjb21wbGV4IHBvbGljaWVzLgojICBJbnN0YW5jZSBzaW1wbHkgcmV0dXJucyB0aGUgc2FtZSByZXN1bHQsIGFsd2F5cywgd2l0aG91dAojICBkb2luZyBhbnl0aGluZy4KIwojICByY29kZSBtYXkgYmUgb25lIG9mIHRoZSBmb2xsb3dpbmcgdmFsdWVzOgojICAtIHJlamVjdCAgIC0gUmVqZWN0IHRoZSB1c2VyLgojICAtIGZhaWwgICAgIC0gU2ltdWxhdGUgb3IgaW5kaWNhdGUgYSBmYWlsdXJlLgojICAtIG9rICAgICAgIC0gU2ltdWxhdGUgb3IgaW5kaWNhdGUgYSBzdWNjZXNzLgojICAtIGhhbmRsZWQgIC0gSW5kaWNhdGUgdGhhdCB0aGUgcmVxdWVzdCBoYXMgYmVlbiBoYW5kbGVkLAojICAgICAgICAgICAgICAgc3RvcCBwcm9jZXNzaW5nLCBhbmQgc2VuZCByZXNwb25zZSBpZiBzZXQuCiMgIC0gaW52YWxpZCAgLSBJbmRpY2F0ZSB0aGF0IHRoZSByZXF1ZXN0IGlzIGludmFsaWQuCiMgIC0gdXNlcmxvY2sgLSBJbmRpY2F0ZSB0aGF0IHRoZSB1c2VyIGFjY291bnQgaGFzIGJlZW4KIyAgICAgICAgICAgICAgIGxvY2tlZCBvdXQuCiMgIC0gbm90Zm91bmQgLSBJbmRpY2F0ZSB0aGF0IGEgdXNlciBhY2NvdW50IGNhbid0IGJlIGZvdW5kLgojICAtIG5vb3AgICAgIC0gU2ltdWxhdGUgYSBuby1vcC4KIyAgLSB1cGRhdGVkICAtIEluZGljYXRlIHRoYXQgdGhlIHJlcXVlc3QgaGFzIGJlZW4gdXBkYXRlZC4KIwojICBJZiBhbiBpbnN0YW5jZSBpcyBsaXN0ZWQgaW4gYSBzZXNzaW9uIHt9ICBzZWN0aW9uLCAKIyAgdGhpcyBzaW11bGF0ZXMgYSB1c2VyIGhhdmluZyA8aW50ZWdlcj4gc2Vzc2lvbnMuCiMgIAojICBzaW11bGNvdW50ID0gPGludGVnZXI+CiMKIyAgSWYgYW4gaW5zdGFuY2UgaXMgbGlzdGVkIGluIGEgc2Vzc2lvbiB7fSAgc2VjdGlvbiwgCiMgIHRoaXMgc2ltdWxhdGVzIHRoZSB1c2VyIGhhdmluZyBtdWx0aWxpbmsKIyAgc2Vzc2lvbnMuCiMKIyAgbXBwID0gPGludGVnZXI+CiMKYWx3YXlzIHJlamVjdCB7CglyY29kZSA9IHJlamVjdAp9CmFsd2F5cyBmYWlsIHsKCXJjb2RlID0gZmFpbAp9CmFsd2F5cyBvayB7CglyY29kZSA9IG9rCn0KYWx3YXlzIGhhbmRsZWQgewoJcmNvZGUgPSBoYW5kbGVkCn0KYWx3YXlzIGludmFsaWQgewoJcmNvZGUgPSBpbnZhbGlkCn0KYWx3YXlzIHVzZXJsb2NrIHsKCXJjb2RlID0gdXNlcmxvY2sKfQphbHdheXMgbm90Zm91bmQgewoJcmNvZGUgPSBub3Rmb3VuZAp9CmFsd2F5cyBub29wIHsKCXJjb2RlID0gbm9vcAp9CmFsd2F5cyB1cGRhdGVkIHsKCXJjb2RlID0gdXBkYXRlZAp9Cg==";

    $mods_enabled["realm"]="IyAtKi0gdGV4dCAtKi0KIwojICAkSWQ6IDM2ODI1ZTBmZTc3Y2I1MTUyMTliYTdmZWJjMzcxOTI5ODhlZDlmYmEgJAoKIyBSZWFsbSBtb2R1bGUsIGZvciBwcm94eWluZy4KIwojICBZb3UgY2FuIGhhdmUgbXVsdGlwbGUgaW5zdGFuY2VzIG9mIHRoZSByZWFsbSBtb2R1bGUgdG8KIyAgc3VwcG9ydCBtdWx0aXBsZSByZWFsbSBzeW50YXhlcyBhdCB0aGUgc2FtZSB0aW1lLiAgVGhlCiMgIHNlYXJjaCBvcmRlciBpcyBkZWZpbmVkIGJ5IHRoZSBvcmRlciB0aGF0IHRoZSBtb2R1bGVzIGFyZSBsaXN0ZWQKIyAgaW4gdGhlIGF1dGhvcml6ZSBhbmQgcHJlYWNjdCBzZWN0aW9ucy4KIwojICBGb3VyIGNvbmZpZyBvcHRpb25zOgojCWZvcm1hdAkgLSAgbXVzdCBiZSAicHJlZml4IiBvciAic3VmZml4IgojCQkJICBUaGUgc3BlY2lhbCBjYXNlcyBvZiAiREVGQVVMVCIKIwkJCSAgYW5kICJOVUxMIiBhcmUgYWxsb3dlZCwgdG9vLgojCWRlbGltaXRlciAgICAgIC0gIG11c3QgYmUgYSBzaW5nbGUgY2hhcmFjdGVyCgojICAncmVhbG0vdXNlcm5hbWUnCiMKIyAgVXNpbmcgdGhpcyBlbnRyeSwgSVBBU1MgdXNlcnMgaGF2ZSB0aGVpciByZWFsbSBzZXQgdG8gIklQQVNTIi4KcmVhbG0gSVBBU1MgewoJZm9ybWF0ID0gcHJlZml4CglkZWxpbWl0ZXIgPSAiLyIKfQoKIyAgJ3VzZXJuYW1lQHJlYWxtJwojCnJlYWxtIHN1ZmZpeCB7Cglmb3JtYXQgPSBzdWZmaXgKCWRlbGltaXRlciA9ICJAIgoKCSMgVGhlIG5leHQgMyBjb25maWd1cmF0aW9uIGl0ZW1zIGFyZSB2YWxpZCBPTkxZCgkjIGZvciBhIHRydXN0LXJvdXRlci4gIEZvciBhbGwgb3RoZXIgcmVhbG1zLAoJIyB0aGV5IGFyZSBpZ25vcmVkLgojCXRydXN0X3JvdXRlciA9ICJsb2NhbGhvc3QiCiMJdHJfcG9ydCA9IDEyMzA5CiMJcnBfcmVhbG0gPSAicGFpbmxlc3Mtc2VjdXJpdHkuY29tIgojCWRlZmF1bHRfY29tbXVuaXR5ID0gImFwYy5tb29uc2hvdC5qYS5uZXQiCn0KCiMgICd1c2VybmFtZSVyZWFsbScKIwpyZWFsbSByZWFsbXBlcmNlbnQgewoJZm9ybWF0ID0gc3VmZml4CglkZWxpbWl0ZXIgPSAiJSIKfQoKIwojICAnZG9tYWluXHVzZXInCiMKcmVhbG0gbnRkb21haW4gewoJZm9ybWF0ID0gcHJlZml4CglkZWxpbWl0ZXIgPSAiXFwiCn0K";

    foreach ($mods_enabled as $fname => $encoded) {
        @file_put_contents("/etc/freeradius/modules/$fname", base64_decode($encoded));
        _out("Starting:/etc/freeradius/modules/$fname done...");
    }

    $mods_config_attr_filter["access_challenge"]="IwojCUNvbmZpZ3VyYXRpb24gZmlsZSBmb3IgdGhlIHJsbV9hdHRyX2ZpbHRlciBtb2R1bGUuCiMJUGxlYXNlIHNlZSBybG1fYXR0cl9maWx0ZXIoNSkgbWFucGFnZSBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KIwojCSRJZDogMTJlZDYxOWNmMTZmNzMyMjIyMWVmMmRmYWYyOGY5YzM2YzYxNmUzYyAkCiMKIwlUaGlzIGNvbmZpZ3VyYXRpb24gZmlsZSBpcyB1c2VkIHRvIHJlbW92ZSBhbG1vc3QgYWxsIG9mIHRoZQojCWF0dHJpYnV0ZXMgRnJvbSBhbiBBY2Nlc3MtQ2hhbGxlbmdlIG1lc3NhZ2UuICBUaGUgUkZDcyBzYXkKIwl0aGF0IGFuIEFjY2Vzcy1DaGFsbGVuZ2UgcGFja2V0IGNhbiBjb250YWluIG9ubHkgYSBmZXcKIwlhdHRyaWJ1dGVzLiAgV2UgZW5mb3JjZSB0aGF0IGhlcmUuCiMKREVGQVVMVAoJRUFQLU1lc3NhZ2UgPSogQU5ZLAoJU3RhdGUgPSogQU5ZLAoJTWVzc2FnZS1BdXRoZW50aWNhdG9yID0qIEFOWSwKCVJlcGx5LU1lc3NhZ2UgPSogQU5ZLAoJUHJveHktU3RhdGUgPSogQU5ZLAoJU2Vzc2lvbi1UaW1lb3V0ID0qIEFOWSwKCUlkbGUtVGltZW91dCA9KiBBTlkK";
    $mods_config_attr_filter["post-proxy"]="IwojCUNvbmZpZ3VyYXRpb24gZmlsZSBmb3IgdGhlIHJsbV9hdHRyX2ZpbHRlciBtb2R1bGUuCiMJUGxlYXNlIHNlZSBybG1fYXR0cl9maWx0ZXIoNSkgbWFucGFnZSBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KIwojCSRJZDogNWQ4ODllYTczM2VjOGU2YjI0NjMzNWY4NmJmNmUxMjJiNTRmMjNhYSAkCiMKIwlUaGlzIGZpbGUgY29udGFpbnMgc2VjdXJpdHkgYW5kIGNvbmZpZ3VyYXRpb24gaW5mb3JtYXRpb24KIwlmb3IgZWFjaCByZWFsbS4gVGhlIGZpcnN0IGZpZWxkIGlzIHRoZSByZWFsbSBuYW1lIGFuZAojCWNhbiBiZSB1cCB0byAyNTMgY2hhcmFjdGVycyBpbiBsZW5ndGguIFRoaXMgaXMgZm9sbG93ZWQgKG9uCiMJdGhlIG5leHQgbGluZSkgd2l0aCB0aGUgbGlzdCBvZiBmaWx0ZXIgcnVsZXMgdG8gYmUgdXNlZCB0bwojCWRlY2lkZSB3aGF0IGF0dHJpYnV0ZXMgYW5kL29yIHZhbHVlcyB3ZSBhbGxvdyBwcm94eSBzZXJ2ZXJzCiMJdG8gcGFzcyB0byB0aGUgTkFTIGZvciB0aGlzIHJlYWxtLgojCiMJV2hlbiBhIHByb3h5LXJlcGx5IHBhY2tldCBpcyByZWNlaXZlZCBmcm9tIGEgaG9tZSBzZXJ2ZXIsCiMJdGhlc2UgYXR0cmlidXRlcyBhbmQgdmFsdWVzIGFyZSB0ZXN0ZWQuIE9ubHkgdGhlIGZpcnN0IG1hdGNoCiMJaXMgdXNlZCB1bmxlc3MgdGhlICJGYWxsLVRocm91Z2giIHZhcmlhYmxlIGlzIHNldCB0byAiWWVzIi4KIwlJbiB0aGF0IGNhc2UgdGhlIHJ1bGVzIGRlZmluZWQgaW4gdGhlIERFRkFVTFQgY2FzZSBhcmUKIwlwcm9jZXNzZWQgYXMgd2VsbC4KIwojCUEgc3BlY2lhbCByZWFsbSBuYW1lZCAiREVGQVVMVCIgbWF0Y2hlcyBvbiBhbGwgcmVhbG0gbmFtZXMuCiMJWW91IGNhbiBoYXZlIG9ubHkgb25lIERFRkFVTFQgZW50cnkuIEFsbCBlbnRyaWVzIGFyZSBwcm9jZXNzZWQKIwlpbiB0aGUgb3JkZXIgdGhleSBhcHBlYXIgaW4gdGhpcyBmaWxlLiBUaGUgZmlyc3QgZW50cnkgdGhhdAojCW1hdGNoZXMgdGhlIGxvZ2luLXJlcXVlc3Qgd2lsbCBzdG9wIHByb2Nlc3NpbmcgdW5sZXNzIHlvdSB1c2UKIwl0aGUgRmFsbC1UaHJvdWdoIHZhcmlhYmxlLgojCiMJSW5kZW50ZWQgKHdpdGggdGhlIHRhYiBjaGFyYWN0ZXIpIGxpbmVzIGZvbGxvd2luZyB0aGUgZmlyc3QKIwlsaW5lIGluZGljYXRlIHRoZSBmaWx0ZXIgcnVsZXMuCiMKIwlZb3UgY2FuIGluY2x1ZGUgYW5vdGhlciBgYXR0cnMnIGZpbGUgd2l0aCBgJElOQ0xVREUgYXR0cnMub3RoZXInCiMKCiMKIyBUaGlzIGlzIGEgY29tcGxldGUgZW50cnkgZm9yIHJlYWxtICJmaXNwIi4gTm90ZSB0aGF0IHRoZXJlIGlzIG5vCiMgRmFsbC1UaHJvdWdoIGVudHJ5IHNvIHRoYXQgbm8gREVGQVVMVCBlbnRyeSB3aWxsIGJlIHVzZWQsIGFuZCB0aGUKIyBzZXJ2ZXIgd2lsbCBOT1QgYWxsb3cgYW55IG90aGVyIGEvdiBwYWlycyBvdGhlciB0aGFuIHRoZSBvbmVzCiMgbGlzdGVkIGhlcmUuCiMKIyBUaGVzZSBydWxlcyBhbGxvdzoKIyAgICAgbyAgT25seSBGcmFtZWQtVXNlciBTZXJ2aWNlLVR5cGVzICggbm8gdGVsbmV0LCBybG9naW4sIHRjcC1jbGVhciApCiMgICAgIG8gIFBQUCBzZXNzaW9ucyAoIG5vIFNMSVAsIENTTElQLCBldGMuICkKIyAgICAgbyAgZHluYW1pYyBpcCBhc3NpZ25tZW50ICggY2FuJ3QgYXNzaWduIGEgc3RhdGljIGlwICkKIyAgICAgbyAgYW4gaWRsZSB0aW1lb3V0IHZhbHVlIHNldCB0byA2MDAgc2Vjb25kcyAoMTAgbWluKSBvciBsZXNzCiMgICAgIG8gIGEgbWF4IHNlc3Npb24gdGltZSBzZXQgdG8gMjg4MDAgc2Vjb25kcyAoOCBob3Vycykgb3IgbGVzcwojCiNmaXNwCiMJU2VydmljZS1UeXBlID09IEZyYW1lZC1Vc2VyLAojCUZyYW1lZC1Qcm90b2NvbCA9PSBQUFAsCiMJRnJhbWVkLUlQLUFkZHJlc3MgPT0gMjU1LjI1NS4yNTUuMjU0LAojCUlkbGUtVGltZW91dCA8PSA2MDAsCiMJU2Vzc2lvbi1UaW1lb3V0IDw9IDI4ODAwCgojCiMgVGhpcyBpcyBhIGNvbXBsZXRlIGVudHJ5IGZvciByZWFsbSAidGlzcCIuIE5vdGUgdGhhdCB0aGVyZSBpcyBubwojIEZhbGwtVGhyb3VnaCBlbnRyeSBzbyB0aGF0IG5vIERFRkFVTFQgZW50cnkgd2lsbCBiZSB1c2VkLCBhbmQgdGhlCiMgc2VydmVyIHdpbGwgTk9UIGFsbG93IGFueSBvdGhlciBhL3YgcGFpcnMgb3RoZXIgdGhhbiB0aGUgb25lcwojIGxpc3RlZCBoZXJlLgojCiMgVGhlc2UgcnVsZXMgYWxsb3c6CiMgICAgICAgbyBPbmx5IExvZ2luLVVzZXIgU2VydmljZS1UeXBlICggbm8gZnJhbWVkL3BwcCBzZXNzaW9ucyApCiMgICAgICAgbyBUZWxuZXQgc2Vzc2lvbnMgb25seSAoIG5vIHJsb2dpbiwgdGNwLWNsZWFyICkKIyAgICAgICBvIExvZ2luIGhvc3Qgb2YgMTkyLjAuMi4xCiMKI3Rpc3AKIwlTZXJ2aWNlLVR5cGUgPT0gTG9naW4tVXNlciwKIwlMb2dpbi1TZXJ2aWNlID09IFRlbG5ldCwKIwlMb2dpbi1UQ1AtUG9ydCA9PSAyMywKIwlMb2dpbi1JUC1Ib3N0ID09IDE5Mi4wLjIuMQoKIwojIFRoZSBmb2xsb3dpbmcgZXhhbXBsZSBjYW4gYmUgdXNlZCBmb3IgYSBob21lIHNlcnZlciB3aGljaCBpcyBvbmx5CiMgYWxsb3dlZCB0byBzdXBwbHkgYSBSZXBseS1NZXNzYWdlLCBhIFNlc3Npb24tVGltZW91dCBhdHRyaWJ1dGUgb2YKIyBtYXhpbXVtIDg2NDAwLCBhIElkbGUtVGltZW91dCBhdHRyaWJ1dGUgb2YgbWF4aW11bSA2MDAgYW5kIGEKIyBBY2N0LUludGVyaW0tSW50ZXJ2YWwgYXR0cmlidXRlIGJldHdlZW4gMzAwIGFuZCAzNjAwLgojIEFsbCBvdGhlciBhdHRyaWJ1dGVzIHNlbnQgYmFjayB3aWxsIGJlIGZpbHRlcmVkIG91dC4KIwojc3RyaWN0cmVhbG0KIwlSZXBseS1NZXNzYWdlID0qIEFOWSwKIwlTZXNzaW9uLVRpbWVvdXQgPD0gODY0MDAsCiMJSWRsZS1UaW1lb3V0IDw9IDYwMCwKIwlBY2N0LUludGVyaW0tSW50ZXJ2YWwgPj0gMzAwLAojCUFjY3QtSW50ZXJpbS1JbnRlcnZhbCA8PSAzNjAwCgojCiMgVGhpcyBpcyBhIGNvbXBsZXRlIGVudHJ5IGZvciByZWFsbSAic3BhbXJlYWxtIi4gRmFsbC1UaHJvdWdoIGlzIHVzZWQsCiMgc28gdGhhdCB0aGUgREVGQVVMVCBmaWx0ZXIgcnVsZXMgYXJlIHVzZWQgaW4gYWRkaXRpb24gdG8gdGhlc2UuCiMKIyBUaGVzZSBydWxlcyBhbGxvdzoKIyAgICAgICBvIEZvcmNlIHRoZSBhcHBsaWNhdGlvbiBvZiBGaWx0ZXItSUQgYXR0cmlidXRlIHRvIGJlIHJldHVybmVkCiMgICAgICAgICBpbiB0aGUgcHJveHkgcmVwbHksIHdoZXRoZXIgdGhlIHByb3h5IHNlbnQgaXQgb3Igbm90LgojICAgICAgIG8gVGhlIHN0YW5kYXJkIERFRkFVTFQgcnVsZXMgYXMgZGVmaW5lZCBiZWxvdwojCiNzcGFtcmVhbG0KIwlGcmFtZWQtRmlsdGVyLUlkIDo9ICJub3NtdHAuaW4iLAojCUZhbGwtVGhyb3VnaCA9IFllcwoKIwojIFRoZSByZXN0IG9mIHRoaXMgZmlsZSBjb250YWlucyB0aGUgREVGQVVMVCBlbnRyeS4KIyBERUZBVUxUIG1hdGNoZXMgd2l0aCBhbGwgcmVhbG0gbmFtZXMuIChleGNlcHQgaWYgdGhlIHJlYWxtIHByZXZpb3VzbHkKIyBtYXRjaGVkIGFuIGVudHJ5IHdpdGggbm8gRmFsbC1UaHJvdWdoKQojCgpERUZBVUxUCglGcmFtZWQtSVAtQWRkcmVzcyA9PSAyNTUuMjU1LjI1NS4yNTQsCglGcmFtZWQtSVAtTmV0bWFzayA9PSAyNTUuMjU1LjI1NS4yNTUsCglGcmFtZWQtTVRVID49IDU3NiwKCUZyYW1lZC1GaWx0ZXItSUQgPSogQU5ZLAoJUmVwbHktTWVzc2FnZSA9KiBBTlksCglQcm94eS1TdGF0ZSA9KiBBTlksCglFQVAtTWVzc2FnZSA9KiBBTlksCglNZXNzYWdlLUF1dGhlbnRpY2F0b3IgPSogQU5ZLAoJTVMtTVBQRS1SZWN2LUtleSA9KiBBTlksCglNUy1NUFBFLVNlbmQtS2V5ID0qIEFOWSwKCU1TLUNIQVAtTVBQRS1LZXlzID0qIEFOWSwKCVN0YXRlID0qIEFOWSwKCVNlc3Npb24tVGltZW91dCA8PSAyODgwMCwKCUlkbGUtVGltZW91dCA8PSA2MDAsCglDYWxsaW5nLVN0YXRpb24tSWQgPSogQU5ZLAoJT3BlcmF0b3ItTmFtZSA9KiBBTlksCglQb3J0LUxpbWl0IDw9IDIK";
    $mods_config_attr_filter["pre-proxy"]="IwojCUNvbmZpZ3VyYXRpb24gZmlsZSBmb3IgdGhlIHJsbV9hdHRyX2ZpbHRlciBtb2R1bGUuCiMJUGxlYXNlIHNlZSBybG1fYXR0cl9maWx0ZXIoNSkgbWFucGFnZSBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KIwojCSRJZDogNDdiMDEyNjZmNDRkMDQ3NTI2MWM2ZWExNmY3NGNhMTdkODgzODc0OSAkCiMKIwlUaGlzIGZpbGUgY29udGFpbnMgc2VjdXJpdHkgYW5kIGNvbmZpZ3VyYXRpb24gaW5mb3JtYXRpb24KIwlmb3IgZWFjaCByZWFsbS4gSXQgY2FuIGJlIHVzZWQgYmUgYW4gcmxtX2F0dHJfZmlsdGVyIG1vZHVsZQojCWluc3RhbmNlIHRvIGZpbHRlciBhdHRyaWJ1dGVzIGJlZm9yZSBzZW5kaW5nIHBhY2tldHMgdG8gdGhlCiMJaG9tZSBzZXJ2ZXIgb2YgYSByZWFsbS4KIwojCVdoZW4gYSBwYWNrZXQgaXMgc2VudCB0byBhIGhvbWUgc2VydmVyLCB0aGVzZSBhdHRyaWJ1dGVzCiMJYW5kIHZhbHVlcyBhcmUgdGVzdGVkLiBPbmx5IHRoZSBmaXJzdCBtYXRjaCBpcyB1c2VkIHVubGVzcwojCXRoZSAiRmFsbC1UaHJvdWdoIiB2YXJpYWJsZSBpcyBzZXQgdG8gIlllcyIuIEluIHRoYXQgY2FzZQojCXRoZSBydWxlcyBkZWZpbmVkIGluIHRoZSBERUZBVUxUIGNhc2UgYXJlIHByb2Nlc3NlZCBhcyB3ZWxsLgojCiMJQSBzcGVjaWFsIHJlYWxtIG5hbWVkICJERUZBVUxUIiBtYXRjaGVzIG9uIGFsbCByZWFsbSBuYW1lcy4KIwlZb3UgY2FuIGhhdmUgb25seSBvbmUgREVGQVVMVCBlbnRyeS4gQWxsIGVudHJpZXMgYXJlIHByb2Nlc3NlZAojCWluIHRoZSBvcmRlciB0aGV5IGFwcGVhciBpbiB0aGlzIGZpbGUuIFRoZSBmaXJzdCBlbnRyeSB0aGF0CiMJbWF0Y2hlcyB0aGUgbG9naW4tcmVxdWVzdCB3aWxsIHN0b3AgcHJvY2Vzc2luZyB1bmxlc3MgeW91IHVzZQojCXRoZSBGYWxsLVRocm91Z2ggdmFyaWFibGUuCiMKIwlUaGUgZmlyc3QgbGluZSBpbmRpY2F0ZXMgdGhlIHJlYWxtIHRvIHdoaWNoIHRoZSBydWxlcyBhcHBseS4KIwlJbmRlbnRlZCAod2l0aCB0aGUgdGFiIGNoYXJhY3RlcikgbGluZXMgZm9sbG93aW5nIHRoZSBmaXJzdAojCWxpbmUgaW5kaWNhdGUgdGhlIGZpbHRlciBydWxlcy4KIwoKIyBUaGlzIGlzIGEgY29tcGxldGUgZW50cnkgZm9yICdub2NoYXAnIHJlYWxtLiBJdCBhbGxvd3MgdG8gc2VuZCB2ZXJ5CiMgYmFzaWMgYXR0cmlidXRlcyB0byB0aGUgaG9tZSBzZXJ2ZXIuIE5vdGUgdGhhdCB0aGVyZSBpcyBubyBGYWxsLVRocm91Z2gKIyBlbnRyeSBzbyB0aGF0IG5vIERFRkFVTFQgZW50cnkgd2lsbCBiZSB1c2VkLiBPbmx5IHRoZSBsaXN0ZWQgYXR0cmlidXRlcwojIHdpbGwgYmUgc2VudCBpbiB0aGUgcGFja2V0LCBhbGwgb3RoZXIgYXR0cmlidXRlcyB3aWxsIGJlIGZpbHRlcmVkIG91dC4KIwojbm9jaGFwCiMJVXNlci1OYW1lID0qIEFOWSwKIwlVc2VyLVBhc3N3b3JkID0qIEFOWSwKIwlOQVMtSVAtQWRkcmVzcyA9KiBBTlksCiMJTkFTLUlkZW50aWZpZXIgPSogQU5ZCgojIFRoZSBlbnRyeSBmb3IgdGhlICdicm9rZW5hcycgcmVhbG0gcmVtb3ZlcyB0aGUgYXR0cmlidXRlIE5BUy1Qb3J0LVR5cGUKIyBpZiBpdHMgdmFsdWUgaXMgZGlmZmVyZW50IGZyb20gJ0V0aGVybmV0Jy4gVGhlbiB0aGUgZGVmYXVsdCBydWxlcyBhcmUKIyBhcHBsaWVkLgojCiNicm9rZW5hcwojCU5BUy1Qb3J0LVR5cGUgPT0gRXRoZXJuZXQKIwlGYWxsLVRocm91Z2ggPSBZZXMKCiMgVGhlIHJlc3Qgb2YgdGhpcyBmaWxlIGNvbnRhaW5zIHRoZSBERUZBVUxUIGVudHJ5LgojIERFRkFVTFQgbWF0Y2hlcyB3aXRoIGFsbCByZWFsbSBuYW1lcy4KCkRFRkFVTFQKCVVzZXItTmFtZSA9KiBBTlksCglVc2VyLVBhc3N3b3JkID0qIEFOWSwKCUNIQVAtUGFzc3dvcmQgPSogQU5ZLAoJQ0hBUC1DaGFsbGVuZ2UgPSogQU5ZLAoJTVMtQ0hBUC1DaGFsbGVuZ2UgPSogQU5ZLAoJTVMtQ0hBUC1SZXNwb25zZSA9KiBBTlksCglFQVAtTWVzc2FnZSA9KiBBTlksCglNZXNzYWdlLUF1dGhlbnRpY2F0b3IgPSogQU5ZLAoJU3RhdGUgPSogQU5ZLAoJTkFTLUlQLUFkZHJlc3MgPSogQU5ZLAoJTkFTLUlkZW50aWZpZXIgPSogQU5ZLAoJT3BlcmF0b3ItTmFtZSA9KiBBTlksCglDYWxsaW5nLVN0YXRpb24tSWQgPSogQU5ZLAoJQ2hhcmdlYWJsZS1Vc2VyLUlkZW50aXR5ID0qIEFOWSwKCVByb3h5LVN0YXRlID0qIEFOWQo=";
    $mods_config_attr_filter["access_reject"]="IwojCUNvbmZpZ3VyYXRpb24gZmlsZSBmb3IgdGhlIHJsbV9hdHRyX2ZpbHRlciBtb2R1bGUuCiMJUGxlYXNlIHNlZSBybG1fYXR0cl9maWx0ZXIoNSkgbWFucGFnZSBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KIwojCSRJZDogYWZkODk0NzNkYzUwZTRmZjYyMzg5ZTM1ZTVjYjczYjUxMmU5ZDM1MiAkCiMKIwlUaGlzIGNvbmZpZ3VyYXRpb24gZmlsZSBpcyB1c2VkIHRvIHJlbW92ZSBhbG1vc3QgYWxsIG9mIHRoZSBhdHRyaWJ1dGVzCiMJRnJvbSBhbiBBY2Nlc3MtUmVqZWN0IG1lc3NhZ2UuICBUaGUgUkZDcyBzYXkgdGhhdCBhbiBBY2Nlc3MtUmVqZWN0CiMJcGFja2V0IGNhbiBjb250YWluIG9ubHkgYSBmZXcgYXR0cmlidXRlcy4gIFdlIGVuZm9yY2UgdGhhdCBoZXJlLgojCkRFRkFVTFQKCUVBUC1NZXNzYWdlID0qIEFOWSwKCVN0YXRlID0qIEFOWSwKCU1lc3NhZ2UtQXV0aGVudGljYXRvciA9KiBBTlksCglFcnJvci1DYXVzZSA9KiBBTlksCglSZXBseS1NZXNzYWdlID0qIEFOWSwKCU1TLUNIQVAtRXJyb3IgPSogQU5ZLAoJUHJveHktU3RhdGUgPSogQU5ZLAoJRnJlZVJBRElVUy1SZXNwb25zZS1EZWxheSA9KiBBTlksCglGcmVlUkFESVVTLVJlc3BvbnNlLURlbGF5LVVTZWMgPSogQU5ZCg==";
    $mods_config_attr_filter["accounting_response"]="IwojCUNvbmZpZ3VyYXRpb24gZmlsZSBmb3IgdGhlIHJsbV9hdHRyX2ZpbHRlciBtb2R1bGUuCiMJUGxlYXNlIHNlZSBybG1fYXR0cl9maWx0ZXIoNSkgbWFucGFnZSBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KIwojCSRJZDogMDFlOWM2ZjViZGE3YTEzOGY0NWRhNTAxMGM2MjRkOTJiNmQzOThhMCAkCiMKIwlUaGlzIGNvbmZpZ3VyYXRpb24gZmlsZSBpcyB1c2VkIHRvIHJlbW92ZSBhbG1vc3QgYWxsIG9mIHRoZSBhdHRyaWJ1dGVzCiMJRnJvbSBhbiBBY2NvdW50aW5nLVJlc3BvbnNlIG1lc3NhZ2UuICBUaGUgUkZDJ3Mgc2F5IHRoYXQgYW4KIwlBY2NvdW50aW5nLVJlc3BvbnNlIHBhY2tldCBjYW4gY29udGFpbiBvbmx5IGEgZmV3IGF0dHJpYnV0ZXMuCiMJV2UgZW5mb3JjZSB0aGF0IGhlcmUuCiMKREVGQVVMVAoJVmVuZG9yLVNwZWNpZmljID0qIEFOWSwKCU1lc3NhZ2UtQXV0aGVudGljYXRvciA9KiBBTlksCglFcnJvci1DYXVzZSA9KiBBTlksCglQcm94eS1TdGF0ZSA9KiBBTlkK";



    foreach ($mods_config_attr_filter as $fname => $encoded) {
        @file_put_contents("/etc/freeradius/mods-config/attr_filter/$fname", base64_decode($encoded));
        _out("Starting:/etc/freeradius/mods-config/attr_filter/$fname done...");
    }

    $f=array();
    $f[]="#lameuser	Auth-Type := Reject";
    $f[]="#		Reply-Message = \"Your account has been disabled.\"";
    $f[]="#DEFAULT	Group == \"disabled\", Auth-Type := Reject";
    $f[]="#		Reply-Message = \"Your account has been disabled.\"";
    $f[]="#steve	Cleartext-Password := \"testing\"";
    $f[]="#	Service-Type = Framed-User,";
    $f[]="#	Framed-Protocol = PPP,";
    $f[]="#	Framed-IP-Address = 172.16.3.33,";
    $f[]="#	Framed-IP-Netmask = 255.255.255.0,";
    $f[]="#	Framed-Routing = Broadcast-Listen,";
    $f[]="#	Framed-Filter-Id = \"std.ppp\",";
    $f[]="#	Framed-MTU = 1500,";
    $f[]="#	Framed-Compression = Van-Jacobsen-TCP-IP";
    $f[]="#bob	Cleartext-Password := \"hello\"";
    $f[]="#	Reply-Message := \"Hello, %{User-Name}\"";
    $f[]="#\"John Doe\"	Cleartext-Password := \"hello\"";
    $f[]="#		Reply-Message = \"Hello, %{User-Name}\"";
    $f[]="#Deg	Cleartext-Password := \"ge55ged\"";
    $f[]="#	Service-Type = Callback-Login-User,";
    $f[]="#	Login-IP-Host = 0.0.0.0,";
    $f[]="#	Callback-Number = \"9,5551212\",";
    $f[]="#	Login-Service = Telnet,";
    $f[]="#	Login-TCP-Port = Telnet";
    $f[]="";
    $f[]="#dialbk	Cleartext-Password := \"callme\"";
    $f[]="#	Service-Type = Callback-Login-User,";
    $f[]="#	Login-IP-Host = timeshare1,";
    $f[]="#	Login-Service = PortMaster,";
    $f[]="#	Callback-Number = \"9,1-800-555-1212\"";
    $f[]="";
    $f[]="#";
    $f[]="#DEFAULT	Suffix == \".shell\"";
    $f[]="#		Service-Type = Login-User,";
    $f[]="#		Login-Service = Telnet,";
    $f[]="#		Login-IP-Host = your.shell.machine";
    $f[]="";
    $f[]="";
    $f[]="";


    @file_put_contents("/etc/freeradius/mods-config/files/authorize", @implode("\n", $f));
    _out("Starting:/etc/freeradius/mods-config/files/authorize done...");
    $f=array();
    $f[]="#DEFAULT Realm == \"foo.net\", Acct-Type := sql_log.foo";
    $f[]="#DEFAULT Huntgroup-Name == \"wifi\", Acct-Type := sql_log.wifi";
    $f[]="#DEFAULT Client-IP-Address == 10.0.0.1, Acct-Type := sql_log.other";
    $f[]="#DEFAULT Acct-Status-Type == Start, Acct-Type := sql_log.start";
    $f[]="#DEFAULT";
    $f[]="#	User-Name := \"%{%{Stripped-User-Name}:-%{User-Name}}\"";
    $f[]="";

    @mkdir("/etc/freeradius/mods-config/files",0644,true);
    @file_put_contents("/etc/freeradius/mods-config/files/accounting", @implode("\n", $f));
    _out("Starting:/etc/freeradius/mods-config/files/accounting done...");
    $f=array();


    $f[]="#DEFAULT Realm == \"extisp\"";
    $f[]="#	NAS-IP-Address := 10.1.2.3";
    $f[]="#DEFAULT";
    $f[]="#	User-Name := `%{%{Stripped-User-Name}:-%{User-Name}}`";
    $f[]="";
    @mkdir("/etc/freeradius/mods-config/files",0644,true);
    @file_put_contents("/etc/freeradius/mods-config/files/pre-proxy", @implode("\n", $f));
    _out("Starting:/etc/freeradius/mods-config/files/pre-proxy done...");


    $huntgroups="IwojIGh1bnRncm91cHMJVGhpcyBmaWxlIGRlZmluZXMgdGhlIGBodW50Z3JvdXBzJyB0aGF0IHlvdSBoYXZlLiBBCiMJCWh1bnRncm91cCBpcyBkZWZpbmVkIGJ5IHNwZWNpZnlpbmcgdGhlIElQIGFkZHJlc3Mgb2YKIwkJdGhlIE5BUyBhbmQgcG9zc2libHkgYSBwb3J0LgojCiMJCU1hdGNoaW5nIGlzIGRvbmUgd2hpbGUgUkFESVVTIHNjYW5zIHRoZSB1c2VyIGZpbGU7IGlmIGl0CiMJCWluY2x1ZGVzIHRoZSBzZWxlY3Rpb24gY3JpdGVyaWEgIkh1bnRncm91cC1OYW1lID09IFhYWCIKIwkJdGhlIGh1bnRncm91cCBpcyBsb29rZWQgdXAgaW4gdGhpcyBmaWxlIHRvIHNlZSBpZiBpdAojCQltYXRjaGVzLiBUaGVyZSBjYW4gYmUgbXVsdGlwbGUgZGVmaW5pdGlvbnMgb2YgdGhlIHNhbWUKIwkJaHVudGdyb3VwOyB0aGUgZmlyc3Qgb25lIHRoYXQgbWF0Y2hlcyB3aWxsIGJlIHVzZWQuCiMKIwkJVGhpcyBmaWxlIGNhbiBhbHNvIGJlIHVzZWQgdG8gZGVmaW5lIHJlc3RyaWN0ZWQgYWNjZXNzCiMJCXRvIGNlcnRhaW4gaHVudGdyb3Vwcy4gVGhlIHNlY29uZCBhbmQgZm9sbG93aW5nIGxpbmVzCiMJCWRlZmluZSB0aGUgYWNjZXNzIHJlc3RyaWN0aW9ucyAoYmFzZWQgb24gdXNlcm5hbWUgYW5kCiMJCVVOSVggdXNlcmdyb3VwKSBmb3IgdGhlIGh1bnRncm91cC4KIwoKIwojIE91ciBQT1AgaW4gQWxwaGVuIGEvZCBSaWpuIGhhcyAzIHRlcm1pbmFsIHNlcnZlcnMuIENyZWF0ZSBhIEh1bnRncm91cC1OYW1lCiMgY2FsbGVkIEFscGhlbiB0aGF0IG1hdGNoZXMgb24gYWxsIHRocmVlIHRlcm1pbmFsIHNlcnZlcnMuCiMKI2FscGhlbgkJTkFTLUlQLUFkZHJlc3MgPT0gMTkyLjAuMi41CiNhbHBoZW4JCU5BUy1JUC1BZGRyZXNzID09IDE5Mi4wLjIuNgojYWxwaGVuCQlOQVMtSVAtQWRkcmVzcyA9PSAxOTIuMC4yLjcKCiMKIyBUaGUgUE9QIGluIERlbGZ0IGNvbnNpc3RzIG9mIG9ubHkgb25lIHRlcm1pbmFsIHNlcnZlci4KIwojZGVsZnQJCU5BUy1JUC1BZGRyZXNzID09IDE5OC41MS4xMDAuNQoKIwojIFBvcnQgMCBvbiB0aGUgZmlyc3QgdGVybWluYWwgc2VydmVyIGluIEFscGhlbiBhcmUgY29ubmVjdGVkIHRvCiMgYSBodW50Z3JvdXAgdGhhdCBpcyBmb3IgYnVzaW5lc3MgdXNlcnMgb25seS4gTm90ZSB0aGF0IG9ubHkgb25lCiMgb2YgdGhlIHVzZXJuYW1lIG9yIGdyb3VwbmFtZSBoYXMgdG8gbWF0Y2ggdG8gZ2V0IGFjY2VzcyAoT1IvT1IpLgojCiMgTm90ZSB0aGF0IHRoaXMgaHVudGdyb3VwIGlzIGEgc3Vic2V0IG9mIHRoZSAiYWxwaGVuIiBodW50Z3JvdXAuCiMKI2J1c2luZXNzCU5BUy1JUC1BZGRyZXNzID09IDE5OC41MS4xMDAuNSwgTkFTLVBvcnQtSWQgPT0gMAojCQlVc2VyLU5hbWUgPT0gcm9nZXJsLAojCQlVc2VyLU5hbWUgPT0gaGVua3MsCiMJCUdyb3VwID09IGJ1c2luZXNzLAojCQlHcm91cCA9PSBzdGFmZgo=";

    @file_put_contents("/etc/freeradius/mods-config/preprocess/huntgroups", base64_decode($huntgroups));
    _out("Starting:/etc/freeradius/mods-config/preprocess/huntgroups done...");

}
